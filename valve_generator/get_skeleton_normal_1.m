function skeleton = get_skeleton_normal_1()
% 
% hardcoded patient specific MV skeleton
% 

% Copyright (c) 2019, Alexander D. Kaiser
% All rights reserved.
% 
% Redistribution and use in source and binary forms, with or without
% modification, are permitted provided that the following conditions are met:
% 
% 1. Redistributions of source code must retain the above copyright notice, this
%    list of conditions and the following disclaimer.
% 
% 2. Redistributions in binary form must reproduce the above copyright notice,
%    this list of conditions and the following disclaimer in the documentation
%    and/or other materials provided with the distribution.
% 
% 3. Neither the name of the copyright holder nor the names of its
%    contributors may be used to endorse or promote products derived from
%    this software without specific prior written permission.
% 
% THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
% AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
% IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
% DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
% FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
% DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
% SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
% CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
% OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
% OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

debug = true; 


% NB: points are in mm 
ring_pts_raw = 0.1 * [322.088 416.242 199.074 322.538 416.541 198.963 307.477 453.085 194.723 307.319 453.066 194.747 328.519 427.391 196.319 328.607 427.741 196.247 324.91 418.918 198.243 324.914 418.924 198.242 317.403 449.927 193.946 317.239 450.025 193.951 327.157 423.784 197.115 327.278 424.059 197.052 320.449 415.301 199.452 320.626 415.391 199.413 328.81 436.62 194.705 328.804 436.642 194.702 322.576 416.571 198.953 322.77 416.707 198.904 292.566 447.927 197.579 292.417 447.767 197.627 312.146 418.723 199.969 312.398 418.319 200.004 313.047 417.358 200.082 313.115 417.26 200.09 309.404 422.58 199.674 309.623 422.339 199.686 320.728 447.865 193.857 320.618 447.942 193.858 320.524 448.002 193.861 320.267 448.166 193.867 321.745 447.176 193.84 321.578 447.296 193.841 328.952 429.547 195.893 328.961 429.617 195.88 311.959 419.024 199.942 317.754 449.707 193.937 317.48 449.876 193.944 306.009 452.882 194.952 305.706 452.826 195.001 329.003 429.944 195.819 329.005 429.971 195.814 316.955 450.206 193.958 316.725 450.355 193.963 299.177 430.44 199.688 299.563 430.239 199.671 314.294 415.832 200.177 314.329 415.799 200.178 305.536 426.202 199.568 305.789 425.988 199.571 309.307 453.256 194.451 308.994 453.232 194.496 290.686 443.194 198.636 290.684 443.178 198.639 325.387 419.737 198.04 325.563 420.088 197.957 301.544 429.065 199.609 301.947 428.808 199.599 327.368 424.283 197.002 327.526 424.659 196.917 299.581 430.229 199.67 323.585 417.378 198.682 323.586 417.379 198.682 327.79 425.303 196.772 327.964 425.732 196.676 326.021 421.083 197.727 326.271 421.682 197.591 295.788 450.453 196.721 295.672 450.386 196.748 297.502 451.27 196.354 297.063 451.1 196.442 298.085 451.48 196.241 297.612 451.317 196.332 311.537 452.986 194.201 311.299 453.043 194.223 321.132 447.599 193.849 320.961 447.713 193.852 316.265 414.516 200.141 316.685 414.4 200.105 328.951 429.539 195.895 324.24 445.068 193.869 324.167 445.146 193.865 300.586 452.078 195.808 300.289 452.017 195.858 301.572 452.225 195.652 301.073 452.146 195.732 309.657 422.3 199.688 309.669 422.286 199.689 313.5 416.749 200.126 313.871 416.294 200.154 299.089 451.768 196.059 298.585 451.641 196.148 298.158 430.988 199.729 298.209 430.96 199.727 328.513 437.66 194.567 328.333 438.195 194.499 310.007 453.231 194.362 309.861 453.226 194.382 305.147 452.751 195.088 304.835 452.706 195.137 299.586 451.879 195.974 299.117 451.774 196.054 326.575 442.022 194.079 326.515 442.119 194.071 290.625 439.879 199.21 290.642 439.679 199.242 308.34 423.693 199.625 308.588 423.44 199.635 297.589 451.306 196.337 295.541 450.303 196.779 295.114 450.046 196.88 316.388 450.574 193.97 316.164 450.722 193.974 326.978 423.365 197.21 327.066 423.565 197.164 313.168 452.395 194.086 313.02 452.454 194.096 301.036 429.372 199.624 301.341 429.192 199.614 326.453 442.215 194.063 290.704 439.226 199.311 290.719 439.123 199.327 290.81 438.633 199.398 290.823 438.569 199.408 290.942 438.06 199.479 290.952 438.018 199.484 291.108 437.516 199.549 291.327 436.935 199.62 291.528 436.507 199.666 317.962 449.577 193.932 291.123 437.472 199.555 291.303 436.996 199.613 291.577 436.41 199.676 291.786 436.041 199.711 291.868 435.904 199.724 292.078 435.607 199.747 292.218 435.421 199.76 292.399 435.202 199.773 291.277 445.746 198.123 291.141 445.357 198.207 292.604 434.964 199.787 292.745 434.814 199.794 291.566 446.418 197.969 291.507 446.302 197.997 293.022 434.533 199.805 293.115 434.443 199.808 302.247 452.326 195.545 302.18 452.319 195.555 293.46 434.121 199.817 293.503 434.082 199.818 326.498 422.236 197.467 326.615 422.525 197.402 293.901 433.724 199.827 293.911 433.715 199.827 313.988 416.167 200.161 314.289 415.836 200.177 294.439 449.572 197.05 294.235 449.426 197.102 306.06 425.768 199.573 300.873 429.474 199.628 293.647 448.962 197.259 293.622 448.942 197.266 326.918 423.21 197.245 294.035 449.268 197.156 293.672 448.981 197.253 312.771 417.755 200.051 312.893 417.578 200.065 328.587 437.417 194.598 296.643 431.779 199.795 296.896 431.645 199.784 291.978 447.147 197.79 291.739 446.77 197.886 308.286 453.177 194.6 308.044 453.154 194.636 298.14 451.502 196.23 296.457 450.814 196.571 296.035 450.586 196.666 329.183 433.682 195.157 329.164 434.072 195.093 318.274 414.414 199.892 318.682 414.527 199.818 300.406 429.75 199.643 300.606 429.633 199.636 328.815 436.595 194.709 328.811 436.613 194.706 301.422 429.139 199.612 315.375 414.945 200.185 315.579 414.829 200.178 303.072 428.059 199.578 303.447 427.795 199.573 328.066 426.027 196.612 329.047 430.351 195.744 291.487 446.262 198.007 291.452 446.182 198.025 329.109 431.011 195.623 329.129 431.367 195.559 290.595 440.236 199.153 290.603 440.125 199.171 304.372 427.117 199.566 304.459 427.05 199.566 307.2 424.769 199.592 307.428 424.56 199.598 306.52 425.373 199.579 306.75 425.175 199.583 308.973 423.034 199.653 309.286 422.707 199.668 306.965 424.982 199.587 308.728 423.296 199.641 307.7 424.306 199.605 298.838 430.63 199.7 329.057 430.468 195.722 311.299 420.087 199.848 311.488 419.784 199.875 304.692 426.878 199.565 304.938 426.69 199.564 290.772 443.802 198.521 290.688 443.21 198.633 291.013 444.918 198.299 290.919 444.537 198.376 326.68 422.671 197.368 326.755 422.842 197.329 298.507 451.618 196.162 290.573 441.968 198.861 290.569 441.841 198.883 312.491 418.178 200.016 312.53 452.656 194.126 312.215 452.781 194.146 324.609 418.479 198.358 298.765 430.669 199.703 298.788 430.657 199.702 329.051 435.434 194.876 328.982 435.846 194.814 306.493 425.394 199.579 328.938 436.043 194.787 323.584 417.377 198.682 328.716 436.98 194.656 321.416 415.83 199.234 321.592 415.931 199.193 317.618 414.332 199.993 317.861 414.344 199.958 314.811 451.552 194.012 314.527 451.722 194.021 311.641 452.964 194.191 328.202 438.56 194.454 328.178 438.623 194.447 299.62 430.207 199.669 290.572 440.606 199.093 327.96 439.19 194.379 327.942 439.232 194.374 292.181 447.465 197.709 292.08 447.321 197.747 310.265 421.557 199.734 310.599 421.116 199.765 316.514 450.498 193.966 307.059 453.034 194.787 306.873 453.005 194.816 302.195 428.655 199.592 319.428 448.673 193.891 319.427 448.674 193.891 310.724 453.166 194.278 310.647 453.173 194.287 323.901 445.408 193.856 323.794 445.516 193.852 318.305 449.366 193.922 323.754 445.554 193.85 323.566 445.722 193.847 308.233 423.799 199.621 297.143 431.508 199.775 311.685 452.95 194.188 304.728 452.686 195.155 304.405 452.638 195.206 303.462 427.784 199.573 303.811 427.535 199.569 313.381 452.302 194.074 304.508 427.014 199.566 314.309 451.837 194.03 313.97 452.02 194.044 311.717 452.938 194.186 311.208 420.226 199.836 325.532 443.554 193.956 325.374 443.764 193.941 324.868 444.375 193.904 324.693 444.579 193.892 323.957 417.72 198.574 315.556 451.104 193.99 315.406 451.197 193.994 327.388 440.499 194.232 327.331 440.612 194.22 304.164 452.597 195.245 303.848 452.546 195.296 329.106 434.995 194.943 329.056 435.405 194.88 316.006 450.823 193.978 314.739 415.417 200.189 314.868 415.317 200.189 317.185 414.33 200.05 306.446 425.437 199.578 294.281 433.39 199.833 294.484 433.224 199.835 294.821 432.962 199.835 295.169 432.705 199.832 319.986 448.343 193.874 323.149 446.091 193.839 322.835 446.355 193.836 319.178 414.702 199.723 319.437 414.806 199.671 319.743 414.945 199.606 320.111 415.127 199.527 323.263 445.993 193.841 329.175 432.522 195.356 329.183 432.855 195.298 310.841 420.772 199.792 295.602 432.418 199.824 295.779 432.301 199.821 308.619 453.221 194.548 326.302 421.752 197.575 326.346 421.862 197.551 292.944 448.332 197.46 292.781 448.173 197.509 303.436 452.489 195.36 303.256 452.466 195.388 329.155 434.396 195.039 329.152 434.517 195.019 322.073 416.23 199.078 324.333 418.119 198.456 324.565 418.424 198.374 321.255 415.735 199.271 322.901 416.8 198.871 322.97 416.854 198.853 328.679 437.104 194.64 313.698 452.15 194.058 322.044 416.212 199.085 304.018 427.378 199.569 329.152 431.857 195.473 329.178 432.403 195.376 302.981 452.434 195.43 310.981 420.571 199.808 290.563 440.909 199.043 290.564 440.873 199.049 313.539 452.232 194.065 310.923 420.657 199.801 295.962 432.186 199.816 313.874 416.292 200.155 319.017 448.933 193.902 318.78 449.075 193.909 300.176 451.995 195.876 299.881 451.934 195.926 320.653 415.406 199.407 296.347 431.947 199.806 327.808 439.565 194.335 325.961 420.95 197.757 324.177 417.955 198.505 324.285 418.071 198.471 296.559 450.859 196.55 302.875 452.414 195.447 302.66 452.389 195.48 329.145 431.63 195.512 322.135 446.9 193.835 297.406 431.375 199.763 310.201 453.222 194.338 295.283 432.622 199.831 295.381 432.558 199.829 313.178 417.176 200.096 313.379 416.905 200.115 307.619 453.099 194.701 309.926 421.984 199.706 310.168 421.681 199.726 311.202 453.061 194.233 328.795 428.529 196.088 328.818 428.674 196.06 328.253 426.537 196.5 328.333 426.762 196.451 327.103 441.075 194.171 305.546 452.806 195.026 326.739 441.741 194.106 315.719 451.015 193.983 325.358 419.678 198.054 325.37 419.699 198.049 305.435 426.283 199.568 315.971 414.627 200.161 320.709 415.437 199.394 328.178 426.293 196.551 325.738 420.451 197.872 327.041 441.189 194.16 326.923 441.4 194.139 329.089 430.762 195.668 318.518 449.233 193.917 303.458 427.787 199.573 328.47 427.241 196.351 300.901 452.117 195.759 327.423 440.427 194.239 325.185 443.993 193.927 325.1 444.099 193.92 306.521 452.962 194.87 301.69 452.243 195.633 327.694 439.838 194.304 327.626 439.988 194.287 328.635 427.845 196.226 328.732 428.233 196.147 290.621 442.621 198.743 290.595 442.241 198.811 320.141 415.141 199.52 316.912 414.363 200.081 302.34 428.56 199.589 302.673 428.335 199.584 329.186 433.14 195.249 329.188 433.516 195.185 328.881 429.019 195.993 328.947 429.512 195.9 323.25 417.083 198.777 293.263 448.637 197.366 293.14 448.531 197.4 312.613 452.627 194.12 301.651 452.239 195.639 307.97 424.05 199.613 294.881 449.882 196.939 294.723 449.775 196.978 297.501 431.324 199.759 290.56 441.403 198.959 290.56 441.365 198.965 305.024 426.621 199.564 322.675 446.484 193.835 322.356 446.732 193.835 325.925 443.011 193.997 325.645 443.406 193.966 328.409 427.005 196.399 303.624 452.511 195.331 324.547 444.737 193.885 306.199 452.906 194.922 318.973 414.627 199.763 315.099 451.384 194.002 299.619 451.884 195.969 299.972 430.003 199.657 290.879 444.365 198.411 290.815 444.028 198.477 297.871 431.137 199.742 318.243 414.406 199.897 291.047 445.035 198.274 300.082 429.941 199.653 310.199 421.643 199.728 311.664 419.504 199.899 311.748 419.371 199.911 326.061 442.822 194.011 300.162 429.896 199.65 325.134 419.273 198.153 327.598 424.836 196.877 329.141 434.681 194.992 319.723 448.511 193.88 327.749 425.196 196.796 302.942 428.15 199.579 326.248 442.547 194.033 ];  
ring_pts_raw = reshape(ring_pts_raw, 3, []); 

connectivity_raw = [2 0 1 
2 2 3 
2 4 5 
2 6 7 
2 8 9 
2 10 11 
2 12 13 
2 14 15 
2 16 17 
2 18 19 
2 20 21 
2 22 23 
2 24 25 
2 26 27 
2 28 29 
2 1 16 
2 30 31 
2 32 33 
2 34 20 
2 35 36 
2 37 38 
2 39 40 
2 41 42 
2 43 44 
2 45 46 
2 47 48 
2 49 50 
2 51 52 
2 53 54 
2 55 56 
2 57 58 
2 44 59 
2 60 61 
2 11 57 
2 62 63 
2 64 65 
2 66 67 
2 68 69 
2 70 71 
2 72 73 
2 74 75 
2 76 77 
2 78 32 
2 79 80 
2 81 82 
2 83 84 
2 85 86 
2 87 88 
2 89 90 
2 91 92 
2 93 94 
2 95 96 
2 97 98 
2 99 100 
2 101 102 
2 103 104 
2 105 106 
2 71 107 
2 108 109 
2 110 111 
2 112 113 
2 114 115 
2 116 117 
2 102 118 
2 104 119 
2 120 121 
2 122 123 
2 124 125 
2 126 127 
2 128 35 
2 129 130 
2 131 132 
2 133 134 
2 135 136 
2 137 138 
2 139 140 
2 141 142 
2 143 144 
2 145 146 
2 147 148 
2 149 150 
2 151 152 
2 153 154 
2 155 156 
2 48 157 
2 158 116 
2 159 160 
2 161 112 
2 162 163 
2 164 165 
2 166 93 
2 167 168 
2 169 170 
2 171 172 
2 173 70 
2 174 175 
2 176 177 
2 178 179 
2 180 181 
2 182 183 
2 117 184 
2 185 186 
2 187 188 
2 63 189 
2 40 190 
2 191 192 
2 193 194 
2 195 196 
2 197 198 
2 199 200 
2 201 202 
2 203 204 
2 205 199 
2 106 206 
2 200 207 
2 208 43 
2 190 209 
2 210 211 
2 212 213 
2 9 41 
2 214 215 
2 216 217 
2 218 219 
2 90 220 
2 221 222 
2 223 164 
2 224 225 
2 226 6 
2 227 228 
2 229 230 
2 231 201 
2 230 232 
2 219 161 
2 233 60 
2 15 234 
2 235 236 
2 237 238 
2 150 218 
2 239 240 
2 241 72 
2 242 243 
2 59 244 
2 245 195 
2 246 247 
2 248 249 
2 250 251 
2 42 252 
2 33 39 
2 253 254 
2 56 255 
2 256 257 
2 258 259 
2 260 261 
2 262 128 
2 263 264 
2 265 105 
2 168 266 
2 267 241 
2 154 45 
2 268 269 
2 270 271 
2 25 85 
2 272 114 
2 273 212 
2 274 275 
2 225 276 
2 277 210 
2 278 279 
2 280 281 
2 61 282 
2 276 267 
2 283 284 
2 285 286 
2 287 288 
2 289 290 
2 111 291 
2 292 293 
2 294 237 
2 295 231 
2 296 297 
2 298 299 
2 163 159 
2 29 300 
2 301 302 
2 183 14 
2 303 304 
2 215 51 
2 305 306 
2 264 307 
2 36 8 
2 240 274 
2 308 309 
2 251 310 
2 261 263 
2 311 312 
2 67 108 
2 252 110 
2 50 313 
2 314 315 
2 316 317 
2 318 319 
2 320 321 
2 322 0 
2 323 324 
2 325 235 
2 326 327 
2 328 166 
2 275 329 
2 330 322 
2 331 197 
2 332 333 
2 319 334 
2 335 277 
2 336 337 
2 329 338 
2 339 335 
2 312 340 
2 88 341 
2 342 343 
2 293 185 
2 344 345 
2 80 260 
2 13 346 
2 347 167 
2 247 348 
2 165 22 
2 220 173 
2 340 347 
2 349 64 
2 350 351 
2 69 352 
2 353 354 
2 355 332 
2 356 30 
2 266 357 
2 352 174 
2 338 272 
2 358 95 
2 359 360 
2 361 362 
2 172 363 
2 364 365 
2 366 258 
2 367 368 
2 196 103 
2 369 370 
2 286 371 
2 46 292 
2 38 372 
2 373 101 
2 86 364 
2 374 283 
2 375 376 
2 73 366 
2 377 47 
2 378 76 
2 379 325 
2 380 369 
2 236 330 
2 98 268 
2 54 381 
2 382 383 
2 384 193 
2 343 385 
2 383 373 
2 282 350 
2 341 153 
2 94 242 
2 188 386 
2 387 4 
2 84 388 
2 381 349 
2 346 379 
2 389 285 
2 192 137 
2 390 391 
2 254 392 
2 146 393 
2 394 395 
2 100 89 
2 396 397 
2 317 18 
2 398 399 
2 204 24 
2 189 380 
2 400 12 
2 401 294 
2 395 389 
2 402 403 
2 404 405 
2 299 359 
2 92 227 
2 406 407 
2 259 358 
2 107 68 
2 388 81 
2 385 262 
2 313 171 
2 184 55 
2 156 162 
2 327 408 
2 409 410 
2 360 311 
2 5 396 
2 411 224 
2 412 83 
2 255 402 
2 52 398 
2 413 265 
2 414 415 
2 271 331 
2 186 378 
2 357 416 
2 222 417 
2 418 336 
2 213 419 
2 177 320 
2 420 421 
2 422 423 
2 75 26 
2 424 387 
2 405 176 
2 309 404 
2 157 295 
2 362 87 
2 425 318 
2 397 367 
2 170 141 
2 257 342 
2 281 426 
2 392 427 
2 423 278 
2 234 328 
2 269 287 
2 3 253 
2 179 428 
2 371 382 
2 429 239 
2 345 430 
2 17 326 
2 407 78 
2 23 361 
2 426 79 
2 244 431 
2 432 433 
2 115 411 
2 434 91 
2 351 323 
2 393 412 
2 430 99 
2 435 178 
2 354 145 
2 243 246 
2 142 191 
2 428 303 
2 249 169 
2 138 436 
2 431 437 
2 391 280 
2 365 438 
2 160 409 
2 439 440 
2 19 248 
2 441 422 
2 198 273 
2 415 155 
2 442 180 
2 7 443 
2 109 414 
2 376 53 
2 399 221 
2 310 339 
2 209 384 
2 437 442 
2 194 355 
2 77 401 
2 333 308 
2 58 444 
2 321 445 
2 438 250 
2 228 208 
2 348 394 
2 363 2 
2 386 270 
2 284 429 
2 291 374 
2 300 446 
2 27 28 
2 31 74 
2 421 356 
2 302 420 
2 307 301 
2 446 256 
2 232 182 
2 290 229 
2 445 289 
2 334 353 
2 297 298 
2 152 296 
2 337 245 
2 433 214 
2 217 432 
2 436 216 
2 447 62 
2 148 151 
2 144 147 
2 140 143 
2 136 139 
2 134 135 
2 132 133 
2 127 131 
2 130 126 
2 125 129 
2 123 124 
2 121 122 
2 119 120 
2 416 434 
2 419 377 
2 448 187 
2 324 226 
2 202 205 
2 370 424 
2 306 400 
2 304 305 
2 279 390 
2 403 448 
2 113 10 
2 408 233 
2 315 149 
2 82 344 
2 410 316 
2 372 97 
2 288 425 
2 206 203 
2 211 439 
2 427 37 
2 175 66 
2 449 441 
2 368 406 
2 96 49 
2 444 447 
2 417 418 
2 65 314 
2 440 34 
2 238 435 
2 181 158 
2 443 375 
2 21 223 
2 118 449 
2 207 413 ];

first_idx  = connectivity_raw(:,2); 
second_idx = connectivity_raw(:,3); 

valve_ring_pts = zeros(3,length(first_idx)); 
pt_idx = 0; 

current = first_idx(1); 
next = second_idx(1); 
complete = false; 
while true
    
    % add one to value of current when using as matlab index
    pt_idx = pt_idx + 1;
    valve_ring_pts(:,pt_idx) = ring_pts_raw(:, current + 1); 
    
    % search for the next index 
    current = first_idx(find(first_idx == next)); 
    next    = second_idx(find(first_idx == next)); 
    
    if isempty(current)
        error('Did not find a vertex with the correct index'); 
    end 
    
    % periodic return to the first point 
    if current == first_idx(1)
        complete = true; 
        break;
    end 
    
end 

if ~complete
    error('failed to find periodic cycle')
end 

skeleton.valve_ring_pts = valve_ring_pts; 

skeleton.n_ring_pts = size(skeleton.valve_ring_pts,2); 

if skeleton.n_ring_pts ~= pt_idx
    error('inconsistency in lengths')
end 

skeleton.ring_center = mean(skeleton.valve_ring_pts')'; 

radii = zeros(skeleton.n_ring_pts, 1); 
for j=1:skeleton.n_ring_pts
    radii(j) = norm(skeleton.valve_ring_pts(:,j) - skeleton.ring_center); 
end

skeleton.r = mean(radii); 


papillary_raw = 0.1 * [302.399 451.766 171.229 303.986 454.417 171.358 330.227 425.409 171.363 302.453 453.726 171.571 331.228 425.822 171.459 302.977 451.799 171.248 331.841 427.276 171.097 329.672 425.798 171.159]; 
skeleton.papillary = reshape(papillary_raw, [3 8]); 
indices = [5 7 2 4 6 1 3 0] + 1; 

skeleton.papillary = skeleton.papillary(:,indices); 

skeleton.ring_offset_angle = pi/4; 

if debug 
    fig = figure; 
    
    x = squeeze(skeleton.valve_ring_pts(1,:));
    y = squeeze(skeleton.valve_ring_pts(2,:));
    z = squeeze(skeleton.valve_ring_pts(3,:));
    plot3(x,y,z); 
    
    title('valve ring hcm d')
end 





