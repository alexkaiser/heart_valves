function skeleton = get_skeleton_hcm_d()
% 
% hardcoded patient specific MV skeleton
% 

% Copyright (c) 2019, Alexander D. Kaiser
% All rights reserved.
% 
% Redistribution and use in source and binary forms, with or without
% modification, are permitted provided that the following conditions are met:
% 
% 1. Redistributions of source code must retain the above copyright notice, this
%    list of conditions and the following disclaimer.
% 
% 2. Redistributions in binary form must reproduce the above copyright notice,
%    this list of conditions and the following disclaimer in the documentation
%    and/or other materials provided with the distribution.
% 
% 3. Neither the name of the copyright holder nor the names of its
%    contributors may be used to endorse or promote products derived from
%    this software without specific prior written permission.
% 
% THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
% AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
% IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
% DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
% FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
% DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
% SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
% CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
% OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
% OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

debug = true; 


% NB: points are in mm 
ring_pts_raw_early_systole = 0.1 * [83.8484 369.025 269.582 83.7154 369.151 269.632 74.6902 330.511 280.193 74.8712 330.498 280.1 88.4769 362.986 268.088 88.4716 363.018 268.086 88.6647 351.31 269.761 88.6635 351.33 269.759 84.9007 336.554 273.959 84.9111 336.577 273.95 83.2449 369.613 269.807 83.153 369.706 269.841 86.8071 341.748 272.179 86.8898 341.968 272.102 86.97 342.183 272.028 87.0486 342.561 271.93 63.568 345.625 283.692 63.6075 345.369 283.71 58.2136 362.461 283.926 58.319 362.208 283.91 88.5511 362.496 268.123 88.5482 362.523 268.121 63.5255 346.198 283.627 63.5366 345.922 283.663 82.8616 370.006 269.947 82.6473 370.233 270.024 82.0568 370.889 270.232 82.0371 370.912 270.239 73.569 377.411 273.663 73.52 377.437 273.684 57.6297 364.327 283.948 57.7195 363.94 283.959 58.082 370.336 282.8 58.0798 370.326 282.803 85.9725 339.333 272.979 86.0895 339.641 272.872 86.1429 339.784 272.822 86.2775 340.208 272.688 86.1415 366.877 268.714 86.0144 367.014 268.759 67.7176 379.408 276.407 67.3459 379.311 276.615 88.6044 351.864 269.708 88.5516 352.281 269.672 77.052 330.47 278.969 77.2755 330.48 278.851 87.3654 365.548 268.278 87.0809 365.864 268.378 70.2133 331.535 282.369 70.2838 331.506 282.336 81.4743 371.583 270.43 81.2506 371.851 270.506 57.6016 364.47 283.94 57.8652 369.313 283.069 57.8107 369.028 283.14 88.5871 361.052 268.324 88.5982 361.281 268.283 62.8226 377.128 279.302 62.7813 377.095 279.328 61.9525 354.623 283.168 61.9871 354.541 283.163 88.5758 360.771 268.372 80.9864 372.174 270.595 80.8857 372.297 270.628 67.9648 379.444 276.273 59.2333 372.923 281.809 59.2149 372.895 281.822 67.2613 379.288 276.663 80.4299 372.806 270.789 80.2813 372.97 270.841 69.5235 331.985 282.66 69.7232 331.834 282.579 57.9496 369.712 282.964 64.3905 378.142 278.331 64.3433 378.117 278.36 65.7372 378.759 277.537 65.4558 378.645 277.7 75.4997 330.467 279.778 75.8646 330.457 279.589 59.1798 360.371 283.74 59.2085 360.315 283.734 76.5637 375.858 272.339 76.4344 375.938 272.394 62.8171 351.92 283.128 62.8261 351.888 283.128 67.5491 334.484 283.309 67.737 334.122 283.266 87.3959 365.505 268.268 82.27 332.825 275.895 82.511 333.079 275.731 64.9983 378.452 277.968 64.9496 378.428 277.997 64.7455 341.056 283.772 64.8016 340.92 283.763 71.1513 378.644 274.735 71.151 378.644 274.735 58.2551 370.988 282.612 58.0852 370.347 282.797 60.9314 356.863 283.36 60.9501 356.826 283.356 85.451 337.873 273.473 85.6357 338.346 273.305 63.5092 346.519 283.587 63.5134 346.42 283.6 69.2949 332.159 282.752 69.3358 332.135 282.735 76.2297 376.052 272.483 76.1767 376.078 272.507 59.8206 359.095 283.6 59.9958 358.745 283.562 59.6066 359.528 283.646 59.7202 359.296 283.622 88.5017 352.705 269.634 88.4861 352.877 269.616 79.6587 373.615 271.067 79.5421 373.729 271.111 85.6391 338.355 273.301 85.8214 338.887 273.126 79.0114 374.238 271.31 78.9135 374.316 271.349 78.3924 374.728 271.558 78.3517 374.76 271.574 87.7997 346.018 271.014 88.0225 346.668 270.799 60.4859 374.679 280.89 60.4225 374.591 280.936 68.9642 379.44 275.753 68.599 379.454 275.941 60.9532 356.82 283.355 60.9597 356.807 283.354 57.5325 367.289 283.549 57.5315 367.281 283.55 87.4992 344.78 271.358 87.5568 345.035 271.29 58.4564 361.878 283.888 58.4963 361.789 283.881 57.4767 366.742 283.661 57.4652 366.168 283.754 72.1538 378.141 274.289 71.9489 378.243 274.38 63.6183 345.305 283.714 78.0824 374.966 271.683 77.9275 375.065 271.749 85.5551 367.448 268.932 85.2513 367.726 269.048 85.7312 367.274 268.867 85.3127 337.519 273.598 85.3145 337.524 273.597 63.2434 377.44 279.035 63.12 377.353 279.113 86.691 366.329 268.51 86.3925 366.624 268.621 88.4114 358.426 268.813 88.4152 358.463 268.806 87.4613 344.602 271.405 67.1133 379.247 276.746 66.7602 379.143 276.946 86.8563 366.142 268.453 86.7528 366.271 268.487 80.5063 331.39 277.031 80.7446 331.534 276.885 84.1503 368.74 269.468 84.1491 368.741 269.468 84.865 368.087 269.195 84.6139 368.316 269.291 88.2049 364.002 268.075 88.0747 364.347 268.091 88.384 363.494 268.059 88.3322 363.633 268.065 83.5503 369.308 269.694 88.5084 362.772 268.104 88.5561 362.389 268.137 82.9478 369.914 269.916 81.7675 371.228 270.331 82.3755 370.525 270.121 82.1156 370.82 270.212 88.3241 356.964 269.081 88.3304 357.171 269.046 81.1814 371.934 270.529 63.9454 343.704 283.787 63.9506 343.683 283.787 82.44 370.454 270.099 77.5725 330.505 278.693 79.34 373.927 271.186 79.972 373.308 270.951 79.9156 373.361 270.972 80.5877 372.631 270.733 63.8956 377.852 278.633 63.5596 377.642 278.84 84.1487 368.741 269.469 87.1231 342.845 271.848 87.1556 342.979 271.81 83.2824 369.575 269.793 84.8933 336.539 273.965 87.3314 343.839 271.588 87.3698 344.075 271.533 81.6436 371.379 270.373 88.4084 363.433 268.056 78.6899 374.493 271.439 78.6018 374.562 271.474 86.1256 339.739 272.838 80.8494 372.342 270.641 86.9432 342.11 272.053 86.3543 340.391 272.62 86.4021 340.515 272.577 88.5253 359.873 268.535 88.526 359.898 268.531 65.6479 339.114 283.596 65.8202 338.742 283.563 86.6799 341.321 272.31 86.7709 341.627 272.216 60.1414 374.177 281.145 59.9567 373.94 281.278 79.998 373.284 270.941 87.4041 344.29 271.482 87.2362 343.312 271.718 87.2561 343.4 271.694 80.8346 331.592 276.829 80.9014 331.634 276.788 57.6771 368.326 283.316 57.6261 367.993 283.393 88.3516 347.633 270.482 88.3529 347.636 270.48 84.2237 335.274 274.506 84.2248 335.276 274.505 71.1488 378.645 274.736 79.0616 374.198 271.29 72.757 377.833 274.022 72.4404 377.996 274.162 59.5948 373.451 281.54 59.2711 372.972 281.781 57.4775 366.765 283.657 70.7654 331.306 282.116 71.0891 331.171 281.968 61.6133 355.425 283.223 61.6194 355.41 283.222 80.1054 331.139 277.278 80.3267 331.282 277.141 84.2252 335.276 274.505 84.226 335.278 274.504 57.6085 367.88 283.419 81.3152 331.957 276.523 81.465 332.089 276.426 88.5831 361.88 268.2 88.4813 358.888 268.707 88.4906 359.335 268.634 67.2283 379.279 276.681 88.656 351.384 269.754 63.2219 350.038 283.203 63.2518 349.831 283.219 88.6028 361.368 268.268 88.596 361.45 268.259 59.161 360.409 283.744 62.6947 352.402 283.119 62.7527 352.193 283.12 74.2157 330.54 280.435 74.3083 330.533 280.388 59.508 359.722 283.668 88.4187 353.557 269.548 88.4131 353.636 269.539 60.416 357.909 283.47 60.5591 357.615 283.44 63.7268 344.602 283.764 63.8018 344.265 283.776 57.5153 365.124 283.886 57.5431 364.924 283.902 88.5621 360.231 268.461 82.8209 333.393 275.522 82.9923 333.573 275.405 88.3122 356.133 269.213 88.3143 356.408 269.17 64.2316 342.622 283.802 64.2687 342.484 283.803 64.2865 342.419 283.804 63.8275 344.16 283.779 85.9057 339.152 273.042 61.4372 375.822 280.221 61.1989 375.556 280.386 86.4798 340.719 272.505 86.59 341.021 272.402 67.1978 335.248 283.376 67.3211 334.951 283.357 62.5174 376.863 279.501 62.4062 376.771 279.573 66.1751 337.882 283.509 66.2423 337.707 283.5 66.1065 338.06 283.517 83.2604 333.895 275.217 83.4505 334.141 275.08 66.6444 336.647 283.452 66.7866 336.261 283.436 64.5926 378.246 278.21 67.8191 333.967 283.246 68.074 333.509 283.183 64.9339 340.607 283.742 65.0738 340.318 283.713 63.3093 349.402 283.254 63.3586 348.966 283.294 75.081 330.489 279.992 75.4032 330.472 279.827 70.0204 379.132 275.25 69.9311 379.167 275.291 68.5048 379.457 275.99 68.4764 379.456 276.004 63.007 351.173 283.142 63.1096 350.697 283.161 87.7569 345.872 271.058 77.2628 375.48 272.032 76.9904 375.639 272.15 76.3811 330.454 279.321 76.7315 330.463 279.137 84.2279 335.281 274.502 84.6725 336.087 274.149 67.7844 334.033 283.255 82.1648 332.718 275.966 70.514 378.935 275.022 70.4302 378.971 275.061 59.3868 359.958 283.695 81.5897 332.194 276.345 81.8669 332.44 276.163 75.1535 376.602 272.96 74.7692 376.794 273.131 57.7791 363.738 283.959 64.3969 342.02 283.807 64.4547 341.859 283.801 70.2342 379.049 275.151 74.5405 376.909 273.233 69.0976 379.429 275.685 85.6371 338.35 273.303 70.6493 331.355 282.169 88.3311 355.46 269.305 88.3173 355.738 269.27 62.1753 354.035 283.141 62.3926 353.391 283.126 57.5309 367.276 283.552 57.5192 367.164 283.575 63.4219 377.557 278.924 62.831 351.871 283.128 60.2218 358.296 283.512 58.8855 360.974 283.802 58.896 360.952 283.8 57.7767 368.853 283.184 79.6408 330.94 277.55 80.035 331.097 277.32 78.4594 330.595 278.217 78.6111 330.632 278.133 85.1551 337.137 273.738 88.4818 352.915 269.613 57.9245 369.595 282.995 62.6563 352.542 283.117 72.2794 378.077 274.233 63.1265 350.619 283.164 88.3236 354.953 269.386 88.3318 355.226 269.34 60.8421 375.14 280.634 60.6367 374.864 280.783 63.4031 348.559 283.333 63.404 348.547 283.334 66.9033 335.955 283.422 67.0314 335.648 283.402 87.7468 364.95 268.17 87.4105 365.48 268.265 60.9037 375.217 280.591 85.3107 337.514 273.6 88.3739 354.159 269.48 88.3723 354.48 269.432 77.7187 375.201 271.837 61.9587 376.374 279.866 61.7712 376.179 279.993 88.3165 355.843 269.255 66.5791 336.823 283.459 59.8383 373.772 281.365 59.6332 373.502 281.513 71.6529 378.392 274.512 71.6455 378.396 274.515 79.2683 330.83 277.76 79.5671 330.91 277.592 72.4889 330.803 281.295 72.5938 330.786 281.243 88.7264 349.204 270.048 88.7291 349.247 270.04 63.6318 345.226 283.719 63.657 345.077 283.729 58.8395 372.311 282.107 58.6687 372.005 282.242 88.0271 364.483 268.095 88.3837 358.025 268.889 88.3916 358.152 268.865 61.5519 375.946 280.143 58.6651 361.43 283.848 58.6934 361.371 283.842 72.8978 330.71 281.096 76.3467 330.455 279.339 61.6488 355.34 283.218 88.0958 346.887 270.728 88.3313 347.574 270.501 63.9736 343.594 283.789 64.7089 341.157 283.775 68.9739 332.406 282.882 68.9782 332.401 282.88 61.6227 355.402 283.222 88.7152 349.143 270.063 69.8931 331.723 282.507 81.8859 332.457 276.15 88.6703 351.241 269.769 86.7351 366.287 268.494 75.5473 376.404 272.785 75.1822 376.587 272.948 88.3165 356.493 269.156 57.4649 366.15 283.757 85.0093 367.961 269.139 65.3282 339.794 283.66 65.4243 339.598 283.639 62.893 351.656 283.128 88.6123 348.608 270.198 62.0689 376.484 279.792 58.5506 371.764 282.34 58.4194 371.405 282.463 65.9147 338.528 283.546 66.0098 338.289 283.533 66.4362 337.201 283.476 73.3772 330.652 280.855 73.5445 330.63 280.771 86.3451 366.673 268.639 73.1422 377.633 273.851 72.9045 377.759 273.956 60.958 375.28 280.553 58.2962 371.095 282.574 66.8423 336.111 283.43 63.4975 346.987 283.522 71.4814 331.038 281.784 63.4671 347.459 283.466 63.4677 347.454 283.467 66.3867 337.332 283.482 61.1269 356.456 283.32 57.4717 365.564 283.842 62.1572 354.084 283.143 62.1575 354.083 283.143 75.4464 330.471 279.805 68.5217 332.936 283.037 68.6598 332.758 282.992 82.748 333.323 275.57 62.5456 352.881 283.124 62.5562 352.845 283.124 88.5367 352.41 269.661 81.8765 332.449 276.156 67.4344 334.713 283.334 84.8771 336.504 273.979 57.8781 363.392 283.96 57.906 363.296 283.96 77.5085 375.331 271.927 76.8864 375.692 272.196 63.1307 350.596 283.166 58.9812 360.778 283.782 72.967 330.7 281.061 88.7379 349.701 269.967 88.7425 349.839 269.943 63.4452 348.012 283.394 84.4566 368.457 269.351 57.4613 365.768 283.817 65.9345 378.84 277.421 88.5339 348.204 270.3 88.5368 348.22 270.296 69.685 379.255 275.406 87.2657 343.434 271.684 63.4663 347.478 283.464 87.6438 345.426 271.185 88.494 359.423 268.619 81.1434 331.83 276.632 65.067 378.483 277.927 78.2392 330.573 278.335 61.2547 356.197 283.293 62.5189 352.995 283.12 83.0857 333.676 275.341 73.872 330.588 280.607 60.1529 358.436 283.527 66.4051 379.025 277.148 69.4267 379.34 275.527 66.2047 378.949 277.264 64.0938 343.135 283.796 64.5675 341.546 283.79 58.6028 371.899 282.292 88.5751 360.649 268.391 67.1136 335.448 283.389 62.1513 354.106 283.143 88.7472 350.443 269.849 88.7296 350.606 269.834 63.2855 349.575 283.24 75.9421 376.204 272.61 88.4942 359.403 268.622 71.5487 331.02 281.751 83.7931 334.588 274.834 83.9866 334.882 274.689 62.0228 376.44 279.823 62.9708 351.335 283.137 59.1359 372.743 281.887 58.9891 372.531 281.995 88.3473 357.437 268.997 88.3753 357.662 268.948 57.7263 368.59 283.251 88.3816 354.032 269.495 57.9953 363.008 283.957 62.9251 377.208 279.236 88.7073 350.856 269.808 71.6668 330.993 281.694 72.0002 330.916 281.532 62.57 352.796 283.124 88.0656 346.792 270.758 88.0789 346.832 270.745 88.3824 358.001 268.893 58.1668 362.574 283.934 87.6956 345.647 271.124 65.1862 340.088 283.689 72.1775 330.873 281.446 88.3189 356.749 269.116 61.3974 355.91 283.262 60.3595 374.515 280.981 83.7763 334.564 274.846 59.7733 359.187 283.611 87.7789 364.889 268.163 63.4925 347.044 283.516 77.819 330.536 278.56 78.7494 330.669 278.055 68.0941 333.483 283.177 83.7204 334.49 274.887 63.4517 347.88 283.41 74.285 377.043 273.346 73.6342 377.377 273.634 88.4012 347.788 270.432 68.3686 333.134 283.087 88.7424 349.94 269.928 73.5971 377.396 273.65 64.0445 377.947 278.541 58.1923 362.513 283.93 75.1696 376.593 272.953 88.3246 354.923 269.39 65.5407 339.347 283.617 ];
ring_pts_raw_early_systole = reshape(ring_pts_raw_early_systole, 3, []); 

ring_pts_raw = 0.1 * [80.280365 367.072983 276.266655
80.164274 367.186679 276.287554
74.615005 334.907905 280.003729
74.772739 334.894985 279.929096
84.271415 361.796428 275.560797
84.267969 361.823890 275.556055
84.526364 352.237461 277.480317
84.523940 352.253577 277.479654
82.903862 340.057814 277.634899
82.909906 340.078087 277.636472
79.754438 367.606092 276.353660
79.674509 367.691003 276.365333
83.880095 344.508318 277.969947
83.924364 344.689829 277.969976
83.967289 344.866794 277.969697
83.987559 345.183141 277.989628
64.484385 348.051312 283.150515
64.524598 347.827388 283.171452
58.285901 362.431294 283.250844
58.416462 362.201936 283.232396
84.318513 361.377035 275.636627
84.317020 361.400110 275.632309
64.436521 348.557018 283.079489
64.450998 348.312574 283.118225
79.421180 367.965952 276.398492
79.235048 368.175122 276.419743
78.722686 368.785055 276.464998
78.705621 368.806599 276.466301
70.979246 375.308528 277.678817
70.932961 375.336438 277.688954
57.508735 364.125363 283.323171
57.639778 363.774291 283.318293
57.218245 369.492839 282.867495
57.217397 369.483962 282.868823
83.468177 342.474465 277.855668
83.529412 342.736413 277.874245
83.557048 342.857772 277.881800
83.618192 343.218621 277.911660
82.289015 365.168818 275.808544
82.178247 365.289063 275.833622
65.414475 377.544285 279.295901
65.066737 377.463221 279.440863
84.435689 352.685134 277.462081
84.362773 353.021991 277.447769
76.676073 334.808074 279.082837
76.871524 334.806788 279.000653
83.360650 364.011433 275.529307
83.110911 364.285332 275.598451
70.687591 335.619989 281.959216
70.750452 335.600909 281.926970
78.217455 369.439025 276.490693
78.022787 369.693802 276.499043
57.465204 364.254878 283.321872
57.137928 368.583694 282.971048
57.121068 368.330516 282.998606
84.295513 360.152812 275.952078
84.313781 360.345676 275.893815
60.924369 375.514380 281.212195
60.888064 375.484445 281.227282
62.625224 355.628790 282.564715
62.663468 355.561089 282.560970
84.275947 359.916869 276.020312
77.792595 370.002572 276.506669
77.704654 370.120583 276.508548
65.647050 377.570100 279.203518
57.985301 371.765497 282.461734
57.971372 371.741020 282.466897
64.987680 377.443891 279.474391
77.303396 370.611524 276.532986
77.172050 370.770633 276.540474
70.066121 335.974156 282.246965
70.246887 335.851381 282.166503
57.169014 368.937790 282.929645
62.332784 376.431989 280.606876
62.289714 376.409479 280.625992
63.571452 376.983445 280.076855
63.311294 376.882514 280.187140
75.320581 334.857781 279.677386
75.638920 334.839873 279.533420
59.452415 360.550225 283.061438
59.486157 360.500338 283.055885
73.784807 373.661125 277.049755
73.664708 373.744013 277.072814
63.597061 353.407535 282.548980
63.607051 353.381313 282.549225
68.248740 338.168382 282.884937
68.424291 337.837323 282.844452
83.386878 363.974017 275.523542
81.055281 336.760066 277.670447
81.239019 336.986122 277.644367
62.889137 376.711114 280.367417
62.844441 376.689523 280.386772
65.619490 344.047360 283.282072
65.672381 343.929618 283.274386
68.682985 376.642169 278.242491
68.682699 376.642174 278.242441
57.302401 370.071609 282.796290
57.219935 369.502584 282.866501
61.480967 357.500956 282.721858
61.502017 357.469586 282.718506
83.208732 341.213145 277.738655
83.306644 341.623098 277.775047
64.416070 348.839616 283.036509
64.421634 348.752430 283.050408
69.858944 336.114611 282.338241
69.895825 336.096905 282.321505
73.474229 373.862812 277.112459
73.424849 373.890110 277.123977
60.204394 359.423564 282.932046
60.408230 359.118023 282.897821
59.953677 359.803532 282.974227
60.087135 359.599698 282.952097
84.293922 353.363909 277.428196
84.270732 353.502290 277.416808
76.617756 371.400902 276.583855
76.513289 371.513084 276.594294
83.308376 341.630915 277.774943
83.396052 342.091140 277.821033
76.035762 372.016723 276.641617
75.946863 372.094355 276.654416
75.472332 372.506549 276.724110
75.435166 372.538696 276.729264
84.233801 348.013895 277.983685
84.361489 348.529200 277.909435
58.959114 373.311597 282.049896
58.909077 373.233101 282.071060
66.593273 377.526206 278.853232
66.247048 377.554751 278.978843
61.505514 357.464514 282.717597
61.512815 357.453481 282.716844
57.067726 366.786066 283.169188
57.067712 366.778911 283.169190
84.109791 347.014220 278.035292
84.130721 347.221403 278.030548
58.586541 361.903619 283.207416
58.635125 361.823180 283.200039
57.079812 366.298904 283.218180
57.136594 365.784445 283.256168
69.638362 376.096794 278.000484
69.443481 376.207450 278.049102
64.535484 347.771456 283.176194
75.188809 372.746283 276.767033
75.046384 372.846624 276.794127
81.774867 365.669958 275.936701
81.508042 365.914850 276.003187
81.928928 365.516805 275.900373
83.135357 340.904442 277.708923
83.136280 340.908802 277.710045
61.297263 375.797082 281.051802
61.187372 375.718315 281.099371
82.771796 364.690667 275.677650
82.509114 364.947627 275.750916
84.078900 357.977040 276.592257
84.082695 358.007272 276.583678
84.097493 346.869071 278.037265
64.849441 377.409301 279.531961
64.520105 377.320768 279.670650
82.916069 364.527642 275.642633
82.826470 364.640330 275.661533
79.646678 335.493009 277.986374
79.843694 335.617178 277.930290
80.543949 366.816717 276.216692
80.542882 366.817596 276.216497
81.169744 366.234497 276.081604
80.949730 366.437990 276.131051
84.066376 362.671206 275.462135
83.962140 362.969693 275.448384
84.209119 362.233369 275.487567
84.167256 362.352908 275.482774
80.020194 367.328710 276.312647
84.290921 361.612981 275.595026
84.318418 361.285634 275.659860
79.495963 367.881408 276.389657
78.471798 369.103394 276.479759
78.998919 368.445544 276.443923
78.773608 368.720504 276.461936
83.999841 356.789436 276.904614
84.004046 356.956886 276.865039
77.962472 369.772940 276.501019
64.857003 346.368814 283.268164
64.862076 346.350543 283.268372
79.054913 368.379654 276.439495
77.130693 334.815682 278.893922
76.331900 371.708436 276.611095
76.897844 371.100069 276.557848
76.847397 371.151862 276.562942
77.442585 370.442223 276.524279
61.883832 376.169454 280.801325
61.581009 375.979394 280.931588
80.542531 366.817612 276.217391
84.016921 345.418350 277.995953
84.028506 345.529343 277.998601
79.787042 367.571433 276.348718
82.899365 340.044660 277.633886
84.075739 346.240839 278.021785
84.080578 346.435852 278.029485
78.364457 369.245915 276.484566
84.229132 362.180997 275.489039
75.743521 372.271026 276.684620
75.663263 372.340054 276.696159
83.547908 342.819660 277.879644
77.672984 370.163872 276.510157
83.953081 344.806712 277.969872
83.661301 343.371799 277.916456
83.686821 343.475793 277.921525
84.205317 359.168071 276.241584
84.206517 359.188819 276.236100
66.465173 342.371294 283.125718
66.626083 342.046336 283.096810
83.824267 344.151231 277.952748
83.864069 344.407344 277.965427
58.690575 372.864181 282.165849
58.544272 372.655749 282.227096
76.921102 371.076625 276.555142
84.084583 346.613174 278.034425
84.057577 345.804408 278.005322
84.064082 345.877075 278.006785
79.917648 335.667528 277.909737
79.972632 335.703795 277.894887
57.080010 367.708019 283.070782
57.071935 367.412077 283.102570
84.556343 349.290922 277.774876
84.557181 349.293272 277.773505
82.477983 338.927974 277.570397
82.478686 338.929759 277.570367
68.680600 376.643267 278.243007
76.081318 371.976960 276.635046
70.211043 375.763495 277.860779
69.910658 375.939726 277.933493
58.261573 372.226889 282.344008
58.014745 371.807772 282.448839
57.077848 366.319502 283.216497
71.178940 335.462936 281.713468
71.466280 335.365077 281.570785
62.246417 356.293515 282.608263
62.253339 356.281034 282.607441
79.315579 335.274174 278.083475
79.497980 335.399599 278.029855
82.479048 338.929710 277.570444
82.479480 338.931532 277.570356
57.068876 367.311725 283.113406
80.305740 335.989595 277.814089
80.424344 336.107330 277.789882
84.322232 360.852399 275.764734
84.147993 358.355033 276.465648
84.162808 358.723063 276.370814
64.956842 377.436303 279.486734
84.513473 352.297349 277.478371
64.055170 351.852915 282.634080
64.090477 351.679919 282.650803
84.321244 360.419103 275.871952
84.317807 360.488309 275.857092
59.430153 360.584067 283.065233
63.457910 353.803499 282.537172
63.523067 353.632100 282.539646
74.202345 334.932265 280.199693
74.282905 334.926648 280.161175
59.838318 359.974614 282.994437
84.176806 354.049381 277.369428
84.168232 354.112820 277.362345
60.892950 358.394290 282.816522
61.057539 358.141902 282.790352
64.644651 347.152674 283.234498
64.718022 346.858170 283.250521
57.306579 364.845385 283.306553
57.356476 364.664516 283.310647
84.248094 359.465624 276.145004
81.476046 337.262821 277.610385
81.605985 337.421200 277.593159
83.999773 356.119013 277.049833
83.997289 356.340571 277.003444
65.131919 345.419654 283.295493
65.167449 345.298152 283.297987
65.184412 345.240738 283.299742
64.742959 346.766490 283.254802
83.434031 342.319751 277.844306
59.735559 374.334072 281.720391
59.537677 374.095210 281.804951
83.727993 343.646664 277.927775
83.784894 343.899259 277.937824
67.919438 338.871273 282.945777
68.035392 338.596005 282.929271
60.658214 375.273502 281.327601
60.561198 375.190409 281.368902
66.958273 341.280878 283.052340
67.021356 341.123291 283.045213
66.893989 341.441157 283.058328
81.803559 337.706646 277.576514
81.940891 337.924987 277.568135
67.399036 340.159099 283.008499
67.532980 339.804020 282.996309
62.517506 376.525554 280.527653
68.501008 337.695601 282.825360
68.738716 337.276704 282.764792
65.796833 343.658343 283.256517
65.928047 343.410891 283.230324
64.158665 351.320182 282.687366
64.218359 350.952394 282.728979
74.955339 334.885084 279.843970
75.236335 334.864394 279.715174
67.602110 377.176643 278.540308
67.516657 377.215206 278.564705
66.157768 377.561505 279.011807
66.130903 377.561616 279.021013
63.809170 352.793681 282.567975
63.925003 352.400713 282.589507
84.212045 347.897205 277.994849
74.433313 373.270033 276.911246
74.181110 373.433679 276.962445
76.089832 334.820746 279.334790
76.395676 334.815837 279.202258
82.480748 338.934201 277.569878
82.765725 339.646393 277.606221
68.468538 337.755855 282.834032
80.974429 336.664806 277.683046
68.074024 376.959581 278.405350
67.993910 376.999044 278.428325
59.696477 360.183413 283.019259
80.523477 336.200282 277.768468
80.741950 336.418436 277.724642
72.469024 374.442846 277.336388
72.108776 374.647364 277.418625
57.720455 363.590519 283.312087
65.289713 344.888393 283.307144
65.344527 344.748458 283.302789
67.806557 377.085012 278.481303
71.894084 374.770237 277.468148
66.719928 377.509903 278.808223
83.307306 341.626595 277.774777
71.075738 335.497730 281.764772
84.031196 355.577241 277.146669
84.012155 355.801048 277.110247
62.874630 355.144118 282.544682
63.119072 354.614737 282.535884
57.067767 366.774516 283.170613
57.070022 366.674739 283.180434
61.457124 375.902754 280.983507
63.612460 353.367383 282.549366
60.669600 358.728250 282.853304
59.102240 361.089029 283.121246
59.114808 361.069310 283.119288
57.110212 368.175247 283.016160
78.921968 335.110838 278.213226
79.257143 335.237674 278.100248
77.905836 334.850418 278.583097
78.036851 334.877212 278.533761
83.048708 340.570268 277.678769
84.264893 353.532900 277.415103
57.159569 368.833930 282.941793
63.414562 353.918473 282.534179
69.757740 376.027476 277.970724
63.943906 352.336269 282.592954
84.038195 355.170757 277.226687
84.037874 355.389389 277.181812
59.244838 373.723070 281.927630
59.080765 373.475845 281.998744
64.271555 350.607385 282.769888
64.272760 350.597209 282.770910
67.642805 339.521887 282.985294
67.763071 339.240139 282.968203
83.685979 363.491789 275.476772
83.399196 363.952227 275.522979
59.294762 373.792017 281.907085
83.134286 340.900066 277.708706
84.111124 354.532926 277.313412
84.097923 354.789949 277.270059
74.854214 372.984796 276.829430
60.174641 374.832227 281.532430
60.015949 374.655817 281.600667
84.009227 355.885502 277.094491
67.337619 340.320475 283.013672
58.452402 372.507591 282.265843
58.291596 372.271439 282.332355
69.161595 376.369009 278.120450
69.154531 376.373312 278.121941
78.601488 335.028636 278.325972
78.859346 335.086377 278.233550
72.695933 335.123831 280.944606
72.787432 335.113950 280.897960
84.746678 350.537530 277.569368
84.745352 350.572120 277.566511
64.549047 347.702354 283.182124
64.574285 347.571719 283.193916
57.690266 371.233138 282.590000
57.567352 370.966325 282.646710
83.924763 363.087722 275.439967
84.051474 357.649935 276.683203
84.059151 357.753414 276.654755
59.831516 374.445661 281.680088
58.838556 361.499073 283.166619
58.872507 361.445903 283.160629
73.053914 335.055557 280.765369
76.059699 334.823009 279.348189
62.286407 356.222754 282.604423
84.403735 348.702504 277.882475
84.544003 349.244466 277.783667
64.884220 346.272603 283.271442
65.584989 344.136011 283.283982
69.567412 336.311813 282.467254
69.571384 336.307567 282.465216
62.257034 356.274344 282.607574
84.741880 350.488992 277.576893
70.400039 335.764384 282.095221
80.756877 336.433496 277.721236
84.536154 352.181756 277.483432
82.810779 364.654205 275.666625
72.837491 374.232961 277.253202
72.495916 374.426974 277.331066
83.998109 356.409078 276.988217
57.138427 365.768326 283.257504
81.296605 366.122976 276.050749
66.166233 342.960761 283.182584
66.256128 342.792221 283.163558
63.680687 353.191219 282.551183
84.697149 350.063233 277.641822
60.268564 374.931814 281.492011
57.485865 370.755393 282.687242
57.405923 370.438081 282.735657
66.714422 341.857964 283.082158
66.803499 341.644695 283.071816
67.203338 340.665084 283.026696
73.471107 335.021131 280.555537
73.616850 335.005524 280.483329
82.467614 364.990463 275.762232
70.575853 375.547604 277.773009
70.350781 375.683378 277.826372
59.339270 373.848243 281.888257
57.327950 370.165614 282.780606
67.585435 339.665511 282.991785
64.396640 349.251061 282.967810
71.812761 335.273403 281.395777
64.358616 349.660943 282.908341
64.359233 349.656543 282.909421
67.156836 340.784093 283.031303
61.702130 357.156882 282.688205
57.213572 365.242512 283.292375
62.854410 355.184434 282.546118
62.854758 355.183609 282.546125
75.273960 334.862722 279.698366
69.151753 336.774634 282.621245
69.279106 336.617198 282.576658
81.419868 337.201672 277.618388
63.292265 354.195946 282.537823
63.304217 354.166398 282.538103
84.341913 353.126038 277.442672
80.749439 336.426461 277.722620
68.141489 338.377815 282.908185
82.889836 340.013822 277.631706
57.855621 363.276527 283.302393
57.893528 363.189511 283.299573
74.660337 373.117439 276.867081
74.084587 373.488595 276.983692
63.948692 352.317109 282.595091
59.216270 360.913438 283.101841
73.114214 335.049427 280.734419
84.714525 350.938322 277.544687
84.707264 351.049356 277.535404
64.325208 350.139506 282.833463
80.811821 366.563564 276.161178
57.179800 365.426114 283.283231
63.753892 377.055240 279.997397
84.664526 349.741223 277.685759
84.665601 349.754003 277.684144
67.281290 377.312987 278.634480
84.068319 345.904939 278.006779
64.357412 349.677352 282.906258
84.162356 347.538293 278.019072
84.167431 358.795693 276.351178
80.166802 335.878247 277.848134
62.952378 376.738793 280.339826
77.713007 334.843037 278.658972
61.845208 356.938892 282.665765
63.260757 354.289862 282.533403
81.676072 337.511978 277.585460
73.902263 334.973454 280.344099
60.589772 358.849468 282.866692
64.189793 377.218586 279.809881
67.034274 377.408101 278.708702
64.003967 377.151738 279.889803
64.999883 345.870513 283.283711
65.451294 344.475675 283.295034
57.518635 370.874677 282.668128
84.271660 359.814682 276.047556
67.840365 339.055895 282.956977
62.847386 355.202578 282.546053
84.663728 351.535663 277.500029
84.635436 351.667941 277.499103
64.130764 351.465375 282.672647
73.206178 374.022086 277.170997
84.167284 358.779175 276.355206
71.871955 335.262257 281.364682
82.187001 338.319401 277.556636
82.319951 338.580191 277.559775
60.229082 374.892057 281.509204
63.768102 352.927101 282.562170
57.915275 371.606950 282.494149
57.803472 371.423276 282.540876
84.018248 357.172242 276.809358
84.043489 357.354494 276.754079
57.094557 367.942092 283.044088
84.123068 354.430980 277.326363
58.012631 362.928463 283.289076
61.014718 375.586905 281.172906
84.596816 351.870326 277.493624
71.975577 335.246819 281.311517
72.267890 335.199899 281.161329
63.319909 354.126189 282.538424
84.386795 348.627216 277.893673
84.394441 348.658872 277.888672
84.050205 357.630386 276.688075
58.227804 362.533913 283.260102
84.183006 347.716690 278.009343
66.033364 343.213832 283.208573
72.423317 335.171225 281.082130
83.997165 356.615719 276.943883
62.003985 356.698266 282.640050
58.858322 373.165975 282.092617
82.175225 338.298168 277.556360
60.149444 359.504162 282.942020
83.712821 363.438818 275.475242
64.390865 349.300505 282.961342
77.345256 334.832406 278.806813
78.156044 334.904709 278.488550
68.757249 337.253860 282.758970
82.135296 338.232959 277.558606
64.334567 350.025837 282.850058
71.653922 374.913385 277.522614
71.040785 375.271959 277.664312
84.585478 349.413245 277.751205
69.010502 336.949060 282.670602
84.698939 351.130816 277.530754
71.005761 375.292391 277.672099
62.018208 376.255798 280.742686
58.259388 362.478495 283.255478
72.484101 374.433337 277.333189
84.040010 355.146675 277.230559
66.364930 342.574124 283.144255]'; 

connectivity_raw = [2 0 1 
2 2 3 
2 4 5 
2 6 7 
2 8 9 
2 10 11 
2 12 13 
2 14 15 
2 16 17 
2 18 19 
2 20 21 
2 22 23 
2 24 25 
2 26 27 
2 28 29 
2 30 31 
2 32 33 
2 34 35 
2 36 37 
2 38 39 
2 40 41 
2 42 43 
2 44 45 
2 46 47 
2 48 49 
2 50 51 
2 52 30 
2 53 54 
2 55 56 
2 57 58 
2 59 60 
2 61 55 
2 62 63 
2 64 40 
2 65 66 
2 41 67 
2 68 69 
2 70 71 
2 33 72 
2 73 74 
2 75 76 
2 77 78 
2 79 80 
2 81 82 
2 83 84 
2 85 86 
2 87 46 
2 88 89 
2 90 91 
2 92 93 
2 94 95 
2 96 97 
2 98 99 
2 100 101 
2 102 103 
2 104 105 
2 106 107 
2 108 109 
2 110 111 
2 112 113 
2 114 115 
2 116 117 
2 118 119 
2 120 121 
2 122 123 
2 124 125 
2 126 127 
2 128 129 
2 130 131 
2 132 133 
2 134 135 
2 136 137 
2 138 139 
2 17 140 
2 141 142 
2 143 144 
2 39 145 
2 146 147 
2 148 149 
2 150 151 
2 152 153 
2 154 132 
2 155 156 
2 157 158 
2 159 160 
2 161 162 
2 163 164 
2 165 166 
2 167 168 
2 1 169 
2 170 4 
2 171 20 
2 172 24 
2 27 173 
2 174 175 
2 176 177 
2 51 178 
2 179 180 
2 181 174 
2 45 182 
2 115 183 
2 184 185 
2 186 68 
2 187 188 
2 11 172 
2 162 189 
2 190 191 
2 178 62 
2 169 192 
2 193 8 
2 194 195 
2 173 196 
2 197 167 
2 198 199 
2 35 200 
2 201 186 
2 13 202 
2 203 204 
2 205 206 
2 207 208 
2 209 210 
2 211 212 
2 213 184 
2 195 214 
2 215 216 
2 217 218 
2 219 220 
2 221 222 
2 223 224 
2 15 190 
2 95 225 
2 183 226 
2 227 228 
2 229 230 
2 231 136 
2 232 233 
2 234 235 
2 236 237 
2 238 239 
2 220 240 
2 241 242 
2 243 171 
2 244 245 
2 67 246 
2 247 42 
2 248 249 
2 250 251 
2 19 134 
2 252 79 
2 253 254 
2 210 12 
2 255 256 
2 257 110 
2 258 259 
2 260 261 
2 262 263 
2 56 250 
2 264 265 
2 206 266 
2 267 268 
2 145 143 
2 269 270 
2 271 272 
2 272 273 
2 37 203 
2 263 274 
2 275 34 
2 119 198 
2 276 277 
2 278 279 
2 280 281 
2 282 283 
2 284 285 
2 286 284 
2 287 288 
2 289 290 
2 91 291 
2 292 293 
2 294 295 
2 296 297 
2 298 299 
2 300 301 
2 302 303 
2 304 305 
2 306 122 
2 307 308 
2 309 310 
2 311 312 
2 86 313 
2 314 88 
2 315 316 
2 317 257 
2 318 319 
2 320 321 
2 31 322 
2 323 324 
2 316 325 
2 321 326 
2 327 126 
2 328 116 
2 329 232 
2 330 331 
2 332 333 
2 334 335 
2 336 148 
2 84 337 
2 338 260 
2 339 340 
2 54 341 
2 335 231 
2 58 282 
2 342 343 
2 344 345 
2 9 346 
2 80 317 
2 113 347 
2 348 53 
2 349 253 
2 228 350 
2 305 351 
2 352 353 
2 354 355 
2 93 294 
2 356 357 
2 358 359 
2 291 73 
2 360 361 
2 362 354 
2 347 258 
2 346 363 
2 364 365 
2 142 366 
2 367 368 
2 331 369 
2 370 289 
2 371 372 
2 373 374 
2 375 376 
2 377 378 
2 379 380 
2 381 382 
2 140 381 
2 383 384 
2 166 385 
2 7 247 
2 386 387 
2 368 388 
2 389 390 
2 378 391 
2 78 392 
2 393 59 
2 394 395 
2 251 243 
2 180 396 
2 397 92 
2 398 399 
2 235 400 
2 401 379 
2 402 48 
2 403 314 
2 404 6 
2 273 323 
2 237 159 
2 405 150 
2 47 157 
2 406 407 
2 230 65 
2 270 408 
2 137 409 
2 144 410 
2 355 124 
2 411 412 
2 337 413 
2 343 236 
2 414 401 
2 283 415 
2 416 417 
2 418 419 
2 103 22 
2 153 244 
2 420 370 
2 421 422 
2 214 154 
2 151 423 
2 424 425 
2 426 362 
2 417 427 
2 168 165 
2 428 358 
2 99 128 
2 429 102 
2 233 430 
2 399 104 
2 431 432 
2 400 393 
2 285 433 
2 129 434 
2 390 339 
2 410 163 
2 435 264 
2 436 437 
2 350 138 
2 299 438 
2 439 440 
2 274 179 
2 89 441 
2 442 443 
2 43 444 
2 445 403 
2 281 446 
2 312 447 
2 199 120 
2 363 146 
2 387 152 
2 319 445 
2 448 449 
2 450 307 
2 308 451 
2 351 452 
2 427 96 
2 97 32 
2 340 453 
2 188 336 
2 391 454 
2 455 456 
2 147 100 
2 357 457 
2 121 141 
2 164 458 
2 409 459 
2 460 75 
2 21 170 
2 461 462 
2 301 463 
2 423 38 
2 131 334 
2 216 464 
2 465 431 
2 133 466 
2 467 205 
2 376 342 
2 218 468 
2 433 420 
2 469 90 
2 369 269 
2 310 44 
2 470 344 
2 242 318 
2 434 471 
2 101 328 
2 333 472 
2 268 473 
2 127 302 
2 76 469 
2 474 255 
2 105 70 
2 109 475 
2 451 81 
2 156 476 
2 477 327 
2 476 478 
2 117 275 
2 277 426 
2 444 112 
2 479 271 
2 382 262 
2 454 421 
2 419 286 
2 480 397 
2 384 481 
2 482 61 
2 483 280 
2 484 436 
2 485 486 
2 487 296 
2 107 488 
2 249 487 
2 245 489 
2 430 490 
2 491 492 
2 415 493 
2 413 494 
2 495 496 
2 49 329 
2 497 498 
2 341 499 
2 500 364 
2 449 501 
2 502 57 
2 208 418 
2 486 503 
2 313 292 
2 504 505 
2 443 506 
2 440 398 
2 23 16 
2 507 508 
2 498 509 
2 501 510 
2 508 394 
2 511 306 
2 295 512 
2 325 300 
2 513 377 
2 259 500 
2 514 176 
2 361 87 
2 515 234 
2 359 483 
2 297 356 
2 149 502 
2 516 211 
2 517 491 
2 111 518 
2 475 338 
2 453 252 
2 66 495 
2 518 108 
2 200 36 
2 204 278 
2 279 209 
2 202 14 
2 191 215 
2 464 194 
2 185 114 
2 226 118 
2 177 497 
2 175 26 
2 63 201 
2 196 50 
2 69 213 
2 506 349 
2 189 0 
2 25 181 
2 192 10 
2 458 161 
2 385 519 
2 158 405 
2 5 197 
2 60 484 
2 254 83 
2 472 442 
2 432 520 
2 303 64 
2 521 470 
2 380 455 
2 372 229 
2 345 522 
2 239 311 
2 293 523 
2 288 524 
2 471 515 
2 457 525 
2 72 348 
2 265 52 
2 526 527 
2 528 461 
2 452 248 
2 222 528 
2 123 507 
2 529 439 
2 473 287 
2 462 414 
2 524 517 
2 478 460 
2 522 375 
2 261 98 
2 520 429 
2 441 267 
2 224 238 
2 456 530 
2 531 28 
2 489 467 
2 322 448 
2 139 373 
2 446 85 
2 256 2 
2 503 404 
2 463 477 
2 523 529 
2 466 511 
2 225 315 
2 509 386 
2 266 482 
2 392 309 
2 481 416 
2 396 479 
2 530 485 
2 74 532 
2 488 406 
2 246 155 
2 510 533 
2 532 187 
2 519 360 
2 160 217 
2 422 474 
2 125 516 
2 492 223 
2 527 531 
2 534 320 
2 425 227 
2 365 535 
2 525 465 
2 490 504 
2 324 480 
2 493 367 
2 353 330 
2 468 241 
2 447 193 
2 182 521 
2 29 424 
2 536 207 
2 505 513 
2 3 298 
2 459 435 
2 499 219 
2 212 371 
2 407 534 
2 412 536 
2 290 428 
2 366 450 
2 535 352 
2 533 18 
2 326 526 
2 494 304 
2 438 77 
2 82 106 
2 240 130 
2 512 411 
2 496 383 
2 71 402 
2 395 221 
2 388 276 
2 135 389 
2 408 514 
2 437 332 
2 374 94 ];

first_idx  = connectivity_raw(:,2); 
second_idx = connectivity_raw(:,3); 

valve_ring_pts = zeros(3,length(first_idx)); 
valve_ring_pts_early_systole = zeros(3,length(first_idx)); 
pt_idx = 0; 

current = first_idx(1); 
next = second_idx(1); 
complete = false; 
while true
    
    % add one to value of current when using as matlab index
    pt_idx = pt_idx + 1;
    valve_ring_pts(:,pt_idx)               = ring_pts_raw(:, current + 1); 
    valve_ring_pts_early_systole(:,pt_idx) = ring_pts_raw_early_systole(:, current + 1); 
    % search for the next index 
    current = first_idx(find(first_idx == next)); 
    next    = second_idx(find(first_idx == next)); 
    
    if isempty(current)
        error('Did not find a vertex with the correct index'); 
    end 
    
    % periodic return to the first point 
    if current == first_idx(1)
        complete = true; 
        break;
    end 
    
end 

if ~complete
    error('failed to find periodic cycle')
end 

skeleton.valve_ring_pts = valve_ring_pts; 
skeleton.valve_ring_pts_early_systole = valve_ring_pts_early_systole; 

skeleton.n_ring_pts = size(skeleton.valve_ring_pts,2); 

if skeleton.n_ring_pts ~= pt_idx
    error('inconsistency in lengths')
end 

skeleton.ring_center = mean(skeleton.valve_ring_pts')'; 

radii = zeros(skeleton.n_ring_pts, 1); 
for j=1:skeleton.n_ring_pts
    radii(j) = norm(skeleton.valve_ring_pts(:,j) - skeleton.ring_center); 
end

skeleton.r = mean(radii); 

skeleton.ring_offset_angle = pi/24; 

papillary_1 = false; 
if papillary_1
    % NB: points are in mm 
    papillary_raw = 0.1 * [86.1627 360.974 242.215 80.0723 359.194 240.021 76.3977 342.69 241.79 89.1854 357.894 240.64 82.0624 341.068 244.127 82.9452 362.81 242.147 78.759 341.052 243.556 85.1885 341.384 242.839]; 

    % this currently has got to be exactly 8 3d vectors 
    skeleton.papillary = reshape(papillary_raw, [3 8]); 

    % manually observed ordering, because paraview stores this in seemingly
    % random order 
    indices = [1 2 6 4 7 3 0 5] + 1; 
else 
    papillary_raw_early_systole = 0.1 * [85.8746 361.433 242.218 77.8223 341.293 242.888 83.634 362.834 242.202 80.5244 341.195 244.174 82.8805 341.673 244.175 87.6973 359.791 242.049 82.0276 362.158 242.171 78.759 341.052 243.556]; 
    skeleton.papillary_early_systole = reshape(papillary_raw_early_systole, [3 8]); 
    
    skeleton.papillary = 0.1 * [81.063836 359.987445 252.752521
                           75.807380 345.689636 248.726920
                           79.069560 360.966646 252.375456
                           77.929507 345.276497 250.979331
                           79.797861 345.364677 251.966058
                           82.727990 358.763136 252.727290
                           77.632406 360.357029 252.230165
                           76.553889 345.377769 249.628348]';

    indices = [6 1 7 3 4 5 0 2] + 1; 
end 


skeleton.papillary = skeleton.papillary(:,indices); 
skeleton.papillary_early_systole = skeleton.papillary_early_systole(:,indices); 



if debug 
    fig = figure; 
    
    x = squeeze(skeleton.valve_ring_pts(1,:));
    y = squeeze(skeleton.valve_ring_pts(2,:));
    z = squeeze(skeleton.valve_ring_pts(3,:));
    plot3(x,y,z); 
    
    title('valve ring hcm d')
end 





