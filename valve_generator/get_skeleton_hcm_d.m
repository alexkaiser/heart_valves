function skeleton = get_skeleton_hcm_d()
% 
% hardcoded patient specific MV skeleton
% 

debug = true; 


% NB: points are in mm 
ring_pts_raw = 0.1 * [64.8984 344.082 264.8 64.9233 343.957 264.8 64.8257 344.586 264.8 64.9449 343.86 264.8 64.7823 344.82 264.8 65.0577 343.338 264.8 64.7241 345.234 264.8 65.0979 343.197 264.8 64.707 345.432 264.8 65.2167 342.729 264.8 64.6683 345.683 264.8 65.2438 342.667 264.8 64.6143 346.117 264.8 65.4452 342.216 264.8 64.5913 346.192 264.8 65.536 342.008 264.8 64.5645 346.297 264.8 65.5985 341.87 264.8 64.5255 346.55 264.8 65.8775 341.426 264.8 64.4737 346.914 264.8 65.915 341.367 264.8 64.4566 347.075 264.8 66.1206 341.057 264.8 64.3865 347.452 264.8 66.1979 340.941 264.8 64.3769 347.551 264.8 66.2041 340.934 264.8 64.3544 347.82 264.8 66.5652 340.522 264.8 64.3242 348.154 264.8 66.6054 340.477 264.8 64.3177 348.214 264.8 66.932 340.111 264.8 64.3104 348.294 264.8 67.0005 340.05 264.8 64.3053 348.647 264.8 67.3198 339.763 264.8 64.3012 348.805 264.8 67.4335 339.662 264.8 64.2953 349.12 264.8 67.7334 339.395 264.8 64.313 349.395 264.8 67.8721 339.297 264.8 64.3134 349.68 264.8 68.1542 339.093 264.8 64.3232 349.82 264.8 68.3311 338.965 264.8 64.3583 350.298 264.8 68.5701 338.793 264.8 64.364 350.34 264.8 68.8173 338.662 264.8 64.442 350.942 264.8 69.0572 338.531 264.8 64.4486 350.972 264.8 69.3121 338.395 264.8 64.539 351.357 264.8 69.5127 338.287 264.8 64.5696 351.465 264.8 69.8283 338.166 264.8 64.6773 351.861 264.8 70.0251 338.089 264.8 64.7343 352.042 264.8 70.3468 337.963 264.8 64.8485 352.374 264.8 70.5088 337.9 264.8 64.9265 352.568 264.8 70.8814 337.803 264.8 65.0028 352.774 264.8 71.0368 337.76 264.8 65.1961 353.322 264.8 71.4211 337.656 264.8 65.209 353.363 264.8 71.5619 337.618 264.8 65.2188 353.397 264.8 71.9536 337.552 264.8 65.4617 354.191 264.8 72.0775 337.53 264.8 65.4869 354.35 264.8 72.4977 337.454 264.8 65.566 354.834 264.8 72.6153 337.433 264.8 65.5845 354.972 264.8 73.0318 337.395 264.8 65.605 355.195 264.8 73.1375 337.384 264.8 65.6234 355.404 264.8 73.5735 337.339 264.8 65.6244 355.735 264.8 73.6803 337.328 264.8 65.6226 355.834 264.8 74.1068 337.312 264.8 65.6157 356.085 264.8 74.2118 337.308 264.8 65.6099 356.267 264.8 74.6469 337.291 264.8 65.6066 356.3 264.8 74.7586 337.286 264.8 65.5416 356.741 264.8 75.1763 337.286 264.8 65.5137 356.921 264.8 75.2973 337.286 264.8 65.4473 357.285 264.8 75.7142 337.285 264.8 65.3679 357.618 264.8 75.8475 337.285 264.8 65.3355 357.747 264.8 76.2385 337.292 264.8 65.2334 358.119 264.8 76.3935 337.293 264.8 65.1942 358.257 264.8 76.7693 337.297 264.8 65.1677 358.339 264.8 76.9414 337.299 264.8 65.0032 358.82 264.8 77.2948 337.31 264.8 64.9009 359.106 264.8 77.4911 337.313 264.8 64.7278 359.556 264.8 77.8239 337.318 264.8 64.6752 359.691 264.8 78.0442 337.322 264.8 64.5114 360.076 264.8 78.3472 337.343 264.8 64.4622 360.194 264.8 78.5968 337.358 264.8 64.2666 360.633 264.8 78.8747 337.374 264.8 64.2392 360.694 264.8 79.1602 337.391 264.8 64.1089 360.999 264.8 79.3976 337.43 264.8 63.9472 361.363 264.8 79.7017 337.484 264.8 63.8875 361.472 264.8 79.8996 337.52 264.8 63.6696 361.923 264.8 80.2502 337.583 264.8 63.6004 362.061 264.8 80.4127 337.634 264.8 63.3202 362.676 264.8 80.7308 337.745 264.8 63.313 362.69 264.8 80.8945 337.805 264.8 63.3053 362.706 264.8 81.2398 337.938 264.8 63.1127 363.157 264.8 81.344 337.991 264.8 62.9927 363.424 264.8 81.7014 338.192 264.8 62.9564 363.494 264.8 81.7961 338.247 264.8 62.8262 363.825 264.8 82.1736 338.473 264.8 62.7819 363.931 264.8 82.2002 338.491 264.8 62.6387 364.353 264.8 82.6163 338.79 264.8 62.6162 364.938 264.8 82.6373 338.805 264.8 62.6179 365.032 264.8 82.7671 338.9 264.8 62.7382 365.299 264.8 83.0316 339.088 264.8 62.904 365.684 264.8 83.0751 339.12 264.8 62.9641 365.777 264.8 83.465 339.398 264.8 63.2093 366.085 264.8 83.5225 339.439 264.8 63.4906 366.419 264.8 83.8718 339.687 264.8 63.5099 366.441 264.8 83.9792 339.757 264.8 63.748 366.778 264.8 84.3112 339.968 264.8 63.9095 366.988 264.8 84.4401 340.05 264.8 64.2451 367.446 264.8 84.7389 340.239 264.8 64.2772 367.487 264.8 84.9058 340.329 264.8 64.5854 367.909 264.8 85.1864 340.497 264.8 64.765 368.147 264.8 85.3798 340.612 264.8 65.014 368.455 264.8 85.6345 340.764 264.8 65.133 368.613 264.8 85.8678 340.886 264.8 65.1923 368.685 264.8 86.0815 341.034 264.8 65.4964 369.044 264.8 86.3186 341.2 264.8 65.6629 369.225 264.8 86.5148 341.339 264.8 65.8694 369.442 264.8 86.8009 341.535 264.8 66.0612 369.645 264.8 86.9389 341.672 264.8 66.2926 369.866 264.8 87.1617 341.895 264.8 66.423 369.979 264.8 87.2885 342.022 264.8 66.6604 370.174 264.8 87.5441 342.304 264.8 66.8199 370.302 264.8 87.6173 342.41 264.8 67.0622 370.496 264.8 87.8182 342.709 264.8 67.1591 370.562 264.8 87.8784 342.801 264.8 67.4337 370.747 264.8 88.0615 343.147 264.8 67.565 370.833 264.8 88.1098 343.233 264.8 67.8615 371.033 264.8 88.3159 343.61 264.8 68.086 371.177 264.8 88.3557 343.684 264.8 68.3155 371.314 264.8 88.5369 344.075 264.8 68.8006 371.591 264.8 88.5658 344.133 264.8 68.82 371.602 264.8 88.7838 344.569 264.8 68.8334 371.608 264.8 88.8039 344.61 264.8 69.1958 371.778 264.8 89.0324 345.068 264.8 69.2347 371.797 264.8 89.0442 345.095 264.8 69.2363 371.798 264.8 89.2535 345.569 264.8 69.7401 372.023 264.8 89.2589 345.581 264.8 69.8682 372.08 264.8 89.4828 346.072 264.8 70.2466 372.197 264.8 89.4839 346.075 264.8 70.376 372.237 264.8 89.5827 346.288 264.8 70.7815 372.363 264.8 89.71 346.563 264.8 70.896 372.4 264.8 89.7115 346.566 264.8 71.3377 372.489 264.8 89.9396 347.06 264.8 71.4139 372.504 264.8 89.9428 347.067 264.8 71.8822 372.599 264.8 90.1693 347.551 264.8 71.9455 372.612 264.8 90.1726 347.558 264.8 72.453 372.686 264.8 90.398 348.049 264.8 72.4753 372.69 264.8 90.4001 348.054 264.8 72.999 372.766 264.8 90.5886 348.558 264.8 73.0136 372.769 264.8 90.5903 348.562 264.8 73.3867 372.809 264.8 90.5903 348.562 264.8 73.5503 372.826 264.8 90.7892 349.083 264.8 73.5567 372.827 264.8 90.7906 349.088 264.8 74.0818 372.883 264.8 90.9593 349.742 264.8 74.1219 372.885 264.8 90.9628 349.756 264.8 74.6221 372.91 264.8 90.9817 349.839 264.8 74.6716 372.913 264.8 91.0841 350.266 264.8 75.1575 372.937 264.8 91.1164 350.399 264.8 75.2348 372.935 264.8 91.2163 350.911 264.8 75.6967 372.924 264.8 91.2527 351.08 264.8 75.7848 372.922 264.8 91.3074 351.503 264.8 76.2358 372.91 264.8 91.3214 351.609 264.8 76.3452 372.897 264.8 91.3265 351.655 264.8 76.759 372.845 264.8 91.4244 352.226 264.8 76.9024 372.827 264.8 91.4632 352.675 264.8 77.3037 372.774 264.8 91.4698 352.723 264.8 77.4386 372.741 264.8 91.5231 353.102 264.8 77.81 372.646 264.8 91.5468 353.322 264.8 77.9762 372.603 264.8 91.5745 353.696 264.8 78.3319 372.509 264.8 91.6063 353.979 264.8 78.4921 372.452 264.8 91.6246 354.204 264.8 78.8314 372.324 264.8 91.64 354.424 264.8 79.0093 372.256 264.8 91.6551 354.663 264.8 79.3343 372.129 264.8 91.677 354.994 264.8 79.5005 372.05 264.8 91.7084 355.359 264.8 79.8246 371.891 264.8 91.7187 355.577 264.8 79.9827 371.813 264.8 91.7393 355.968 264.8 80.3007 371.657 264.8 91.7489 356.251 264.8 80.4688 371.556 264.8 91.7507 356.451 264.8 80.7633 371.377 264.8 91.7556 356.741 264.8 80.938 371.271 264.8 91.7476 357.043 264.8 81.2257 371.096 264.8 91.7333 357.336 264.8 81.3876 370.98 264.8 91.7108 357.609 264.8 81.667 370.783 264.8 91.6866 358.037 264.8 81.8348 370.664 264.8 91.6666 358.299 264.8 82.1124 370.468 264.8 91.6052 358.824 264.8 82.2623 370.35 264.8 91.603 358.857 264.8 82.5387 370.141 264.8 91.6017 358.871 264.8 82.6987 370.02 264.8 91.5998 358.89 264.8 82.9734 369.812 264.8 91.5518 359.389 264.8 83.1229 369.689 264.8 91.4951 359.78 264.8 83.3911 369.472 264.8 91.4819 359.873 264.8 83.5435 369.349 264.8 91.4698 359.953 264.8 83.8186 369.127 264.8 91.4074 360.426 264.8 83.9551 369.017 264.8 91.3366 360.783 264.8 84.2394 368.784 264.8 91.3192 360.867 264.8 84.3708 368.676 264.8 91.3056 360.927 264.8 84.6673 368.434 264.8 91.1954 361.468 264.8 84.7936 368.34 264.8 91.1075 361.756 264.8 85.0848 368.117 264.8 91.0578 361.939 264.8 85.2292 368.006 264.8 90.8958 362.449 264.8 85.5087 367.792 264.8 90.8514 362.605 264.8 85.6583 367.686 264.8 90.6675 362.998 264.8 85.9539 367.471 264.8 90.6387 363.06 264.8 86.097 367.367 264.8 90.4665 363.417 264.8 86.389 367.155 264.8 90.4007 363.57 264.8 86.5341 367.055 264.8 90.1954 363.857 264.8 86.8386 366.84 264.8 90.1148 363.97 264.8 86.9813 366.74 264.8 89.8999 364.27 264.8 87.2848 366.527 264.8 89.8314 364.377 264.8 87.4239 366.427 264.8 89.5431 364.672 264.8 87.7343 366.204 264.8 89.4226 364.797 264.8 87.8679 366.108 264.8 89.1562 365.065 264.8 88.1776 365.886 264.8 89.0519 365.176 264.8 88.3096 365.777 264.8 88.7436 365.427 264.8 88.6092 365.536 264.8 57.3312 337.951 264.8 57.4677 337.954 264.8 56.8607 337.983 264.8 58.0445 337.969 264.8 56.8374 337.982 264.8 58.165 337.975 264.8 56.7811 337.984 264.8 58.2458 337.975 264.8 56.3087 338.164 264.8 58.737 338.015 264.8 55.8276 338.377 264.8 59.2385 338.042 264.8 55.7258 338.466 264.8 59.3122 338.05 264.8 55.5627 338.627 264.8 59.3528 338.055 264.8 55.4738 338.716 264.8 59.9141 338.117 264.8 55.4084 338.792 264.8 60.2038 338.139 264.8 55.2077 339.092 264.8 60.356 338.172 264.8 55.067 339.291 264.8 60.5648 338.179 264.8 54.9691 339.461 264.8 60.722 338.197 264.8 54.8193 339.693 264.8 61.208 338.265 264.8 54.6943 339.896 264.8 61.2285 338.266 264.8 54.4979 340.154 264.8 61.7232 338.392 264.8 54.3806 340.299 264.8 62.0369 338.441 264.8 54.0283 340.62 264.8 62.1206 338.475 264.8 53.9674 340.676 264.8 62.2305 338.531 264.8 53.9385 340.694 264.8 62.5968 338.738 264.8 53.873 340.73 264.8 62.6842 338.766 264.8 53.544 340.915 264.8 62.9447 338.866 264.8 53.4166 340.976 264.8 63.0036 338.911 264.8 53.1116 340.864 264.8 63.1819 339.096 264.8 53.031 340.827 264.8 63.3815 339.283 264.8 52.7875 340.585 264.8 63.426 339.347 264.8 52.2761 340.54 264.8 63.61 339.578 264.8 52.2451 340.538 264.8 63.6801 339.811 264.8 51.9072 340.51 264.8 63.7958 340.034 264.8 51.7238 340.487 264.8 63.8623 340.37 264.8 51.1547 340.501 264.8 63.8935 340.504 264.8 51.1287 340.51 264.8 63.9161 340.601 264.8 51.1123 340.5 264.8 63.9469 340.948 264.8 50.6446 340.356 264.8 63.9409 341.11 264.8 50.5922 340.389 264.8 63.9544 341.487 264.8 50.5231 340.317 264.8 63.9694 341.726 264.8 50.1162 340.174 264.8 63.9649 341.876 264.8 49.9145 340.188 264.8 63.9183 342.263 264.8 49.6867 340.056 264.8 63.9102 342.517 264.8 49.5604 340.002 264.8 63.911 342.624 264.8 49.186 339.971 264.8 63.8966 342.747 264.8 49.1449 339.96 264.8 63.8548 343.248 264.8 48.5303 339.989 264.8 63.8046 343.571 264.8 48.4786 339.975 264.8 63.7704 343.87 264.8 48.4468 339.971 264.8 63.7603 344.115 264.8 47.9196 340.088 264.8 63.7001 344.503 264.8 47.8814 340.088 264.8 63.6853 344.653 264.8 47.5925 340.221 264.8 63.586 345.361 264.8 47.3475 340.317 264.8 63.5817 345.409 264.8 47.1036 340.467 264.8 63.5223 345.97 264.8 46.821 340.644 264.8 63.5228 345.986 264.8 46.698 340.745 264.8 63.4922 346.478 264.8 46.3808 340.996 264.8 63.4913 346.518 264.8 46.2837 341.096 264.8 63.496 346.946 264.8 46.0389 341.324 264.8 63.498 346.999 264.8 45.7715 341.612 264.8 63.5022 347.637 264.8 45.7354 341.652 264.8 63.5034 347.643 264.8 45.7163 341.671 264.8 63.6369 348.129 264.8 45.3041 342.226 264.8 63.6505 348.194 264.8 45.2635 342.27 264.8 63.9075 348.94 264.8 45.0514 342.635 264.8 63.9241 348.981 264.8 44.9958 342.721 264.8 63.9409 349.034 264.8 44.7153 343.355 264.8 64.0881 349.334 264.8 44.6965 343.395 264.8 64.1506 349.594 264.8 44.6766 343.447 264.8 64.2072 349.753 264.8 44.6497 343.538 264.8 64.3237 350.278 264.8 44.4373 344.263 264.8 64.3336 350.324 264.8 44.3754 344.567 264.8 64.4144 350.921 264.8 44.3556 344.682 264.8 64.427 350.96 264.8 44.3385 344.772 264.8 64.4958 351.375 264.8 44.3097 344.92 264.8 64.4873 351.451 264.8 44.2284 345.327 264.8 64.5478 351.88 264.8 44.1514 345.7 264.8 64.562 352.092 264.8 44.1253 345.819 264.8 64.6232 352.473 264.8 44.0742 346.017 264.8 64.6646 352.628 264.8 44.0027 346.34 264.8 64.7136 352.892 264.8 43.9562 346.536 264.8 64.7183 353.301 264.8 43.9005 346.766 264.8 64.7227 353.322 264.8 43.8469 347 264.8 64.8358 353.748 264.8 43.7761 347.279 264.8 64.8526 353.82 264.8 43.729 347.461 264.8 64.9261 354.205 264.8 43.6585 347.76 264.8 64.9282 354.26 264.8 43.6326 347.867 264.8 64.9222 354.412 264.8 43.5519 348.183 264.8 64.9445 354.621 264.8 43.5268 348.278 264.8 64.9471 354.697 264.8 43.4599 348.593 264.8 64.9785 355.229 264.8 43.4393 348.69 264.8 64.9442 355.393 264.8 43.3691 349.002 264.8 64.9298 355.8 264.8 43.344 349.111 264.8 64.9364 356.066 264.8 43.3259 349.359 264.8 64.8753 356.45 264.8 43.305 349.588 264.8 64.8783 356.623 264.8 43.3028 349.691 264.8 64.872 356.704 264.8 43.289 350.126 264.8 64.8652 356.775 264.8 43.3555 350.613 264.8 64.8534 357.395 264.8 43.3632 350.675 264.8 64.8198 357.656 264.8 43.3959 350.771 264.8 64.7499 358.047 264.8 43.5343 351.148 264.8 64.7273 358.172 264.8 43.6144 351.266 264.8 64.648 358.657 264.8 43.7979 351.559 264.8 64.6041 358.793 264.8 43.8794 351.699 264.8 64.4469 359.325 264.8 44.1605 351.835 264.8 64.3843 359.474 264.8 44.3528 352.025 264.8 64.3008 359.781 264.8 44.7754 352.317 264.8 64.1846 359.975 264.8 44.7785 352.318 264.8 63.7982 360.527 264.8 44.7798 352.32 264.8 63.7879 360.545 264.8 44.7884 352.324 264.8 63.7795 360.557 264.8 45.3568 352.635 264.8 63.6266 360.743 264.8 45.4159 352.68 264.8 63.4453 360.97 264.8 45.6514 352.906 264.8 63.4372 360.98 264.8 45.8371 353.098 264.8 63.1334 361.341 264.8 46.0336 353.418 264.8 63.0193 361.448 264.8 46.0906 353.539 264.8 62.7594 361.694 264.8 46.3257 354.198 264.8 62.3887 362.057 264.8 46.3357 354.237 264.8 62.3188 362.127 264.8 46.4101 354.651 264.8 62.2438 362.189 264.8 46.4239 354.809 264.8 62.0068 362.57 264.8 46.4507 355.155 264.8 61.7556 362.775 264.8 46.4416 355.463 264.8 61.7541 362.777 264.8 46.4362 355.599 264.8 61.7529 362.779 264.8 46.4285 355.689 264.8 61.7504 362.783 264.8 46.3966 356.108 264.8 61.4715 363.371 264.8 46.3374 356.558 264.8 61.1931 363.806 264.8 46.3337 356.594 264.8 61.1572 363.88 264.8 46.2534 357.131 264.8 61.1303 363.923 264.8 46.2491 357.159 264.8 60.9241 364.263 264.8 46.2394 357.222 264.8 60.7027 364.493 264.8 46.1847 357.641 264.8 60.6428 364.59 264.8 46.163 358.034 264.8 60.5031 364.734 264.8 46.1481 358.503 264.8 60.1676 365.003 264.8 46.182 358.821 264.8 59.913 365.185 264.8 46.2323 359.032 264.8 59.8611 365.216 264.8 46.3025 359.155 264.8 59.6293 365.363 264.8 46.4537 359.416 264.8 59.4338 365.412 264.8 46.5489 359.516 264.8 59.0762 365.563 264.8 46.876 359.895 264.8 58.8162 365.675 264.8 47.0676 360.065 264.8 58.6481 365.729 264.8 47.4335 360.425 264.8 58.3283 365.746 264.8 47.4618 360.447 264.8 57.8063 365.811 264.8 47.4706 360.457 264.8 57.7129 365.822 264.8 47.6399 360.612 264.8 57.5332 365.835 264.8 47.8334 360.783 264.8 57.164 365.801 264.8 47.853 360.803 264.8 56.8926 365.817 264.8 48.2252 361.159 264.8 56.7722 365.806 264.8 48.4201 361.3 264.8 56.6831 365.81 264.8 48.6285 361.487 264.8 56.2499 365.769 264.8 48.8255 361.697 264.8 56.114 365.739 264.8 48.9252 361.767 264.8 55.8311 365.727 264.8 49.3103 362.048 264.8 55.64 365.684 264.8 49.4729 362.14 264.8 55.5586 365.675 264.8 49.6655 362.29 264.8 55.1519 365.609 264.8 49.9602 362.492 264.8 54.8317 365.521 264.8 50.2858 362.689 264.8 54.7894 365.503 264.8 50.4525 362.781 264.8 54.7402 365.482 264.8 50.5455 362.856 264.8 54.3684 365.284 264.8 50.7816 362.988 264.8 53.9313 365.111 264.8 50.9317 363.088 264.8 53.861 365.077 264.8 51.2126 363.244 264.8 53.2942 364.668 264.8 51.3774 363.332 264.8 53.2257 364.624 264.8 51.6778 363.526 264.8 53.0071 364.484 264.8 51.8636 363.662 264.8 52.7299 364.274 264.8 52.2339 363.932 264.8 52.4428 364.081 264.8 52.3353 364 264.8 ];
ring_pts_raw = reshape(ring_pts_raw, 3, []); 

connectivity_raw = [2 0 1 
2 232 230 
2 206 204 
2 35 37 
2 201 203 
2 371 373 
2 283 285 
2 114 112 
2 335 337 
2 209 211 
2 134 132 
2 27 29 
2 48 46 
2 319 321 
2 15 17 
2 217 219 
2 251 253 
2 17 19 
2 226 224 
2 243 245 
2 261 263 
2 5 7 
2 225 227 
2 233 235 
2 363 365 
2 269 271 
2 52 50 
2 321 323 
2 84 82 
2 78 76 
2 307 309 
2 222 220 
2 291 293 
2 38 36 
2 329 331 
2 202 200 
2 140 138 
2 148 146 
2 345 347 
2 285 287 
2 90 88 
2 204 202 
2 24 22 
2 273 275 
2 99 101 
2 203 205 
2 91 93 
2 207 209 
2 367 369 
2 83 85 
2 147 149 
2 281 283 
2 75 77 
2 177 179 
2 378 376 
2 386 384 
2 195 197 
2 138 136 
2 370 368 
2 391 392 
2 26 24 
2 361 363 
2 3 5 
2 46 44 
2 298 296 
2 359 361 
2 67 69 
2 306 304 
2 169 171 
2 185 187 
2 290 288 
2 64 62 
2 362 360 
2 215 217 
2 143 145 
2 369 371 
2 314 312 
2 151 153 
2 282 280 
2 28 26 
2 383 385 
2 40 38 
2 322 320 
2 155 157 
2 301 303 
2 274 272 
2 267 269 
2 161 163 
2 174 172 
2 256 254 
2 158 156 
2 173 175 
2 330 328 
2 354 352 
2 338 336 
2 2 0 
2 346 344 
2 199 201 
2 266 264 
2 59 61 
2 248 246 
2 181 183 
2 377 379 
2 165 167 
2 19 21 
2 159 161 
2 135 137 
2 240 238 
2 152 150 
2 259 261 
2 304 302 
2 360 358 
2 368 366 
2 119 121 
2 296 294 
2 312 310 
2 336 334 
2 87 89 
2 111 113 
2 234 232 
2 228 226 
2 352 350 
2 242 240 
2 328 326 
2 239 241 
2 344 342 
2 79 81 
2 103 105 
2 231 233 
2 29 31 
2 172 170 
2 95 97 
2 58 56 
2 320 318 
2 191 193 
2 288 286 
2 127 129 
2 71 73 
2 280 278 
2 272 270 
2 264 262 
2 376 374 
2 198 196 
2 63 65 
2 53 55 
2 250 248 
2 37 39 
2 45 47 
2 223 225 
2 258 256 
2 51 53 
2 253 255 
2 379 381 
2 385 387 
2 245 247 
2 384 382 
2 236 234 
2 230 228 
2 146 144 
2 193 195 
2 112 110 
2 392 390 
2 277 279 
2 166 164 
2 106 104 
2 18 16 
2 1 3 
2 293 295 
2 43 45 
2 34 32 
2 150 148 
2 168 166 
2 54 52 
2 339 341 
2 317 319 
2 116 114 
2 142 140 
2 100 98 
2 271 273 
2 20 18 
2 66 64 
2 156 154 
2 244 242 
2 252 250 
2 260 258 
2 265 267 
2 255 257 
2 237 239 
2 247 249 
2 229 231 
2 221 223 
2 213 215 
2 205 207 
2 197 199 
2 189 191 
2 187 189 
2 179 181 
2 171 173 
2 163 165 
2 50 48 
2 56 54 
2 96 94 
2 270 268 
2 278 276 
2 286 284 
2 294 292 
2 302 300 
2 310 308 
2 318 316 
2 326 324 
2 334 332 
2 342 340 
2 350 348 
2 358 356 
2 366 364 
2 374 372 
2 382 380 
2 390 388 
2 387 389 
2 373 375 
2 365 367 
2 153 155 
2 145 147 
2 137 139 
2 129 131 
2 121 123 
2 113 115 
2 105 107 
2 97 99 
2 89 91 
2 81 83 
2 73 75 
2 65 67 
2 57 59 
2 55 57 
2 47 49 
2 39 41 
2 31 33 
2 23 25 
2 13 15 
2 279 281 
2 220 218 
2 130 128 
2 154 152 
2 30 28 
2 355 357 
2 16 14 
2 200 198 
2 136 134 
2 139 141 
2 107 109 
2 131 133 
2 123 125 
2 115 117 
2 375 377 
2 183 185 
2 21 23 
2 275 277 
2 303 305 
2 381 383 
2 333 335 
2 208 206 
2 194 192 
2 175 177 
2 211 213 
2 14 12 
2 389 391 
2 263 265 
2 167 169 
2 178 176 
2 125 127 
2 133 135 
2 257 259 
2 249 251 
2 388 386 
2 117 119 
2 235 237 
2 241 243 
2 108 106 
2 109 111 
2 380 378 
2 141 143 
2 372 370 
2 120 118 
2 364 362 
2 101 103 
2 356 354 
2 72 70 
2 348 346 
2 227 229 
2 93 95 
2 219 221 
2 340 338 
2 85 87 
2 7 9 
2 149 151 
2 157 159 
2 98 96 
2 77 79 
2 69 71 
2 332 330 
2 61 63 
2 49 51 
2 41 43 
2 33 35 
2 324 322 
2 316 314 
2 82 80 
2 308 306 
2 6 4 
2 300 298 
2 25 27 
2 292 290 
2 284 282 
2 276 274 
2 268 266 
2 262 260 
2 325 327 
2 254 252 
2 246 244 
2 238 236 
2 68 66 
2 212 210 
2 192 190 
2 218 216 
2 341 343 
2 32 30 
2 160 158 
2 80 78 
2 190 188 
2 70 68 
2 323 325 
2 36 34 
2 92 90 
2 8 6 
2 118 116 
2 42 40 
2 343 345 
2 188 186 
2 313 315 
2 88 86 
2 210 208 
2 11 13 
2 4 2 
2 305 307 
2 309 311 
2 110 108 
2 10 8 
2 186 184 
2 299 301 
2 295 297 
2 124 122 
2 353 355 
2 12 10 
2 132 130 
2 311 313 
2 327 329 
2 315 317 
2 76 74 
2 62 60 
2 182 180 
2 287 289 
2 128 126 
2 347 349 
2 60 58 
2 122 120 
2 104 102 
2 349 351 
2 102 100 
2 126 124 
2 162 160 
2 297 299 
2 337 339 
2 351 353 
2 44 42 
2 22 20 
2 184 182 
2 170 168 
2 214 212 
2 176 174 
2 144 142 
2 289 291 
2 9 11 
2 216 214 
2 94 92 
2 164 162 
2 224 222 
2 196 194 
2 74 72 
2 180 178 
2 357 359 
2 86 84 
2 331 333 ];

first_idx  = connectivity_raw(:,2); 
second_idx = connectivity_raw(:,3); 

valve_ring_pts = zeros(3,length(first_idx)); 
pt_idx = 0; 

current = first_idx(1); 
next = second_idx(1); 
complete = false; 
while true
    
    % add one to value of current when using as matlab index
    pt_idx = pt_idx + 1;
    valve_ring_pts(:,pt_idx) = ring_pts_raw(:, current + 1); 
    
    % search for the next index 
    current = first_idx(find(first_idx == next)); 
    next    = second_idx(find(first_idx == next)); 
    
    if isempty(current)
        error('Did not find a vertex with the correct index'); 
    end 
    
    % periodic return to the first point 
    if current == first_idx(1)
        complete = true; 
        break;
    end 
    
end 

if ~complete
    error('failed to find periodic cycle')
end 

skeleton.valve_ring_pts = valve_ring_pts; 

skeleton.n_ring_pts = size(skeleton.valve_ring_pts,2); 

if skeleton.n_ring_pts ~= pt_idx
    error('inconsistency in lengths')
end 

skeleton.ring_center = mean(skeleton.valve_ring_pts')'; 

radii = zeros(skeleton.n_ring_pts, 1); 
for j=1:skeleton.n_ring_pts
    radii(j) = norm(skeleton.valve_ring_pts(:,j) - skeleton.ring_center); 
end

skeleton.r = mean(radii); 

papillary_1 = false; 
if papillary_1
    % NB: points are in mm 
    papillary_raw = 0.1 * [86.1627 360.974 242.215 80.0723 359.194 240.021 76.3977 342.69 241.79 89.1854 357.894 240.64 82.0624 341.068 244.127 82.9452 362.81 242.147 78.759 341.052 243.556 85.1885 341.384 242.839]; 

    % this currently has got to be exactly 8 3d vectors 
    skeleton.papillary = reshape(papillary_raw, [3 8]); 

    % manually observed ordering, because paraview stores this in seemingly
    % random order 
    indices = [1 2 6 4 7 3 0 5] + 1; 
else 
    papillary_raw = 0.1 * [85.8746 361.433 242.218 77.8223 341.293 242.888 83.634 362.834 242.202 80.5244 341.195 244.174 82.8805 341.673 244.175 87.6973 359.791 242.049 82.0276 362.158 242.171 78.759 341.052 243.556]; 
    skeleton.papillary = reshape(papillary_raw, [3 8]); 
    indices = [6 1 7 3 4 5 0 2] + 1; 
end 


skeleton.papillary = skeleton.papillary(:,indices); 


if debug 
    fig = figure; 
    
    x = squeeze(skeleton.valve_ring_pts(1,:));
    y = squeeze(skeleton.valve_ring_pts(2,:));
    z = squeeze(skeleton.valve_ring_pts(3,:));
    plot3(x,y,z); 
    
    title('valve ring hcm d')
end 





