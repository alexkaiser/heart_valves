function skeleton = get_skeleton_hcm_d()
% 
% hardcoded patient specific MV skeleton
% 

% Copyright (c) 2019, Alexander D. Kaiser
% All rights reserved.
% 
% Redistribution and use in source and binary forms, with or without
% modification, are permitted provided that the following conditions are met:
% 
% 1. Redistributions of source code must retain the above copyright notice, this
%    list of conditions and the following disclaimer.
% 
% 2. Redistributions in binary form must reproduce the above copyright notice,
%    this list of conditions and the following disclaimer in the documentation
%    and/or other materials provided with the distribution.
% 
% 3. Neither the name of the copyright holder nor the names of its
%    contributors may be used to endorse or promote products derived from
%    this software without specific prior written permission.
% 
% THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
% AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
% IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
% DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
% FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
% DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
% SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
% CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
% OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
% OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

debug = true; 


% NB: points are in mm 
ring_pts_raw = 0.1 * [83.1902 334.392 282.714 83.5937 334.797 282.714 69.3029 379.749 282.714  69.0094 379.665 282.714 81.8346 372.848 282.714 81.8109 372.871 282.714  78.113 376.428 282.714 77.6867 376.735 282.714 82.0411 333.357 282.714  82.1229 333.431 282.714 62.1065 375.871 282.714 61.8616 375.672 282.714  57.7222 366.733 282.714 57.723 366.662 282.714 59.0076 372.73 282.714  58.8131 372.416 282.714 89.2274 362.184 282.714 89.1946 362.29 282.714  89.3855 361.675 282.714 75.5092 378.506 282.714 75.298 378.664 282.714  88.1116 343.108 282.714 88.1484 343.204 282.714 78.7978 331.142 282.714  79.3034 331.36 282.714 90.128 351.207 282.714 90.1496 351.469 282.714  58.4287 362.58 282.714 58.5527 362.268 282.714 63.9021 344.315 282.714  64.0073 343.918 282.714 85.8652 367.849 282.714 85.8264 367.92 282.714  70.1584 331.536 282.714 70.4988 331.385 282.714 79.874 331.647 282.714  80.002 331.725 282.714 90.0078 358.926 282.714 89.9378 359.333 282.714  59.3281 360.524 282.714 59.4571 360.26 282.714 59.3746 373.24 282.714  59.1282 372.927 282.714 63.7859 377.252 282.714 63.7066 377.188 282.714  82.3331 333.617 282.714 80.6195 332.167 282.714 81.0237 332.473 282.714  89.8359 348.652 282.714 89.9078 349.174 282.714 71.3545 331.059 282.714  71.5636 330.995 282.714 59.9063 359.356 282.714 59.9562 359.253 282.714  82.4889 333.755 282.714 82.8036 334.038 282.714 58.7046 361.879 282.714  58.7198 361.844 282.714 57.7887 367.745 282.714 57.7611 367.396 282.714  78.5555 376.107 282.714 78.3341 376.267 282.714 69.4847 332.009 282.714  69.709 331.826 282.714 62.8973 352.016 282.714 62.9681 351.765 282.714  73.1385 379.679 282.714 72.5415 379.821 282.714 69.8446 379.892 282.714  69.7828 379.884 282.714 71.3921 379.973 282.714 70.9544 379.972 282.714  86.0604 338.155 282.714 86.1499 338.317 282.714 63.6421 348.188 282.714  63.6561 348.031 282.714 63.5418 377.051 282.714 63.2617 376.824 282.714  62.2959 376.028 282.714 62.1994 375.951 282.714 86.6767 339.439 282.714  86.7392 339.599 282.714 72.1931 379.886 282.714 71.8771 379.921 282.714  63.8327 344.605 282.714 88.899 363.041 282.714 88.771 363.356 282.714  58.2327 370.995 282.714 58.1457 370.555 282.714 75.345 330.615 282.714  75.4654 330.622 282.714 60.7835 357.59 282.714 60.8387 357.472 282.714  64.5506 342.013 282.714 64.5693 341.962 282.714 72.058 330.875 282.714  72.482 330.786 282.714 57.8092 365.058 282.714 57.8621 364.65 282.714  69.2598 332.193 282.714 69.3269 332.146 282.714 90.13 358.031 282.714  90.0821 358.426 282.714 60.1748 358.816 282.714 60.3325 358.493 282.714  67.6602 334.484 282.714 67.8035 334.204 282.714 66.6361 337.038 282.714  66.7021 336.858 282.714 81.1411 332.568 282.714 81.5154 332.898 282.714  68.8689 379.628 282.714 68.824 379.612 282.714 81.313 373.378 282.714  81.1815 373.519 282.714 57.9436 369.146 282.714 57.9334 369.066 282.714  68.1832 379.346 282.714 67.8418 379.184 282.714 65.333 340.098 282.714  65.3348 340.094 282.714 84.2619 335.515 282.714 84.2812 335.538 282.714  81.6303 332.999 282.714 81.849 333.192 282.714 57.8722 364.576 282.714  88.4055 364.029 282.714 88.3355 364.159 282.714 57.7364 365.587 282.714  57.7459 365.504 282.714 87.9776 342.747 282.714 88.023 342.869 282.714  89.4906 361.336 282.714 88.5443 344.187 282.714 88.718 344.613 282.714  66.9561 378.841 282.714 66.3682 378.657 282.714 90.2984 355.151 282.714  90.2981 355.175 282.714 76.7506 330.711 282.714 76.9071 330.732 282.714  65.8605 338.96 282.714 65.9685 338.726 282.714 85.0296 336.477 282.714  85.2045 336.729 282.714 75.808 378.259 282.714 75.6985 378.352 282.714  87.7865 364.984 282.714 87.679 365.114 282.714 68.0736 333.664 282.714  88.2695 364.268 282.714 57.8847 368.679 282.714 57.8796 368.635 282.714  67.1712 378.91 282.714 58.3795 371.478 282.714 58.348 371.381 282.714  70.6783 331.304 282.714 71.0118 331.155 282.714 67.6603 379.099 282.714  67.2956 378.953 282.714 76.8629 377.326 282.714 76.6459 377.52 282.714  57.7987 367.866 282.714 61.9732 355.012 282.714 61.9986 354.953 282.714  64.1265 343.498 282.714 64.139 343.453 282.714 83.7812 371.007 282.714  83.7332 371.063 282.714 89.5982 347.252 282.714 89.6561 347.568 282.714  82.9254 334.15 282.714 63.1287 376.714 282.714 62.763 376.409 282.714  73.7737 330.637 282.714 74.2138 330.625 282.714 86.4651 338.99 282.714  86.526 339.121 282.714 67.4133 335.037 282.714 67.5708 334.661 282.714  86.3349 338.722 282.714 86.4285 338.915 282.714 58.1074 370.347 282.714  58.0795 370.149 282.714 58.0179 369.709 282.714 57.9626 369.292 282.714  66.7959 336.605 282.714 66.8515 336.452 282.714 63.6202 348.479 282.714  63.7057 345.635 282.714 63.7065 345.615 282.714 63.4994 349.523 282.714  63.5342 349.252 282.714 83.7211 371.076 282.714 83.2724 371.514 282.714  76.627 377.536 282.714 76.2265 377.906 282.714 90.3001 354.529 282.714  63.0662 351.424 282.714 63.1395 351.149 282.714 63.6077 348.587 282.714  84.6305 369.971 282.714 84.5861 370.039 282.714 90.0789 358.454 282.714  63.763 345.147 282.714 63.787 344.951 282.714 63.4756 349.671 282.714  64.4292 342.428 282.714 64.5378 342.054 282.714 87.2489 365.652 282.714  87.0099 365.969 282.714 90.1889 351.942 282.714 90.2164 352.387 282.714  90.2841 356.049 282.714 90.2797 356.151 282.714 90.2994 354.491 282.714  90.0749 358.479 282.714 90.2629 353.21 282.714 90.2808 353.76 282.714  90.222 357.086 282.714 90.1797 357.553 282.714 58.4406 371.679 282.714  57.7275 366.188 282.714 57.7348 365.723 282.714 82.3101 372.406 282.714  82.2882 372.426 282.714 85.5119 368.503 282.714 85.3403 368.827 282.714  90.2313 352.631 282.714 90.2558 353.061 282.714 90.2265 352.544 282.714  90.2273 352.558 282.714 90.284 353.842 282.714 90.2846 353.868 282.714  90.2954 355.603 282.714 84.9272 369.512 282.714 83.18 371.601 282.714  82.7698 371.983 282.714 83.2492 371.536 282.714 84.0567 370.689 282.714  58.3981 362.659 282.714 90.1691 357.669 282.714 68.1095 333.593 282.714  68.1238 333.566 282.714 63.6969 346.592 282.714 63.6996 346.469 282.714  84.5214 335.822 282.714 70.85 379.974 282.714 70.7832 379.973 282.714  69.7472 379.875 282.714 86.459 366.774 282.714 86.4494 366.787 282.714  80.2651 331.889 282.714 80.4964 332.074 282.714 74.6183 330.613 282.714  74.7154 330.609 282.714 61.5795 375.43 282.714 75.9204 378.159 282.714  66.1378 338.342 282.714 66.2673 338.001 282.714 77.5308 376.846 282.714  77.0308 377.2 282.714 89.1488 362.414 282.714 78.8326 375.904 282.714  85.4563 337.119 282.714 85.7181 337.532 282.714 89.9904 349.84 282.714  90.0218 350.14 282.714 70.2042 379.939 282.714 64.1647 343.359 282.714  74.059 379.366 282.714 73.8281 379.462 282.714 70.5693 331.353 282.714  58.9342 361.369 282.714 58.9825 361.265 282.714 61.8124 355.39 282.714  61.833 355.335 282.714 87.1878 340.691 282.714 87.2749 340.904 282.714  60.1925 374.154 282.714 60.147 374.105 282.714 89.7789 360.161 282.714  89.7283 360.379 282.714 89.7005 347.802 282.714 89.7293 347.954 282.714  59.8567 373.794 282.714 89.5065 361.277 282.714 89.4957 361.32 282.714  63.0068 351.629 282.714 63.2179 350.901 282.714 63.2293 350.863 282.714  90.0964 350.842 282.714 64.8715 341.137 282.714 64.891 341.089 282.714  75.1113 378.811 282.714 72.0365 330.88 282.714 90.2978 355.389 282.714  63.7119 345.575 282.714 90.0501 350.391 282.714 61.3983 375.27 282.714  63.3662 350.27 282.714 63.3729 350.241 282.714 88.9996 362.794 282.714  59.7327 359.705 282.714 59.7342 359.702 282.714 57.7399 367.107 282.714  77.5291 330.809 282.714 77.5812 330.822 282.714 76.3182 330.67 282.714  76.5353 330.683 282.714 89.9259 359.402 282.714 70.2951 379.946 282.714  89.8088 348.453 282.714 63.669 347.695 282.714 61.7454 355.53 282.714  63.6723 347.641 282.714 84.5646 370.071 282.714 84.5038 370.145 282.714  87.5881 341.725 282.714 87.7773 342.209 282.714 86.9591 366.04 282.714  89.6546 360.688 282.714 72.7147 330.755 282.714 80.8163 373.907 282.714  62.4101 353.714 282.714 62.4707 353.511 282.714 80.6844 374.047 282.714  86.8932 366.141 282.714 71.6859 379.942 282.714 87.8204 342.335 282.714  79.9348 374.862 282.714 79.9324 374.865 282.714 74.3646 379.218 282.714  61.5635 355.962 282.714 86.162 367.302 282.714 86.1602 367.306 282.714  86.8613 339.876 282.714 64.4219 342.454 282.714 90.1726 357.638 282.714  67.2867 335.338 282.714 67.3695 335.136 282.714 63.8195 344.696 282.714  89.7793 348.241 282.714 65.9287 378.495 282.714 89.9278 349.345 282.714  89.2258 345.911 282.714 89.2953 346.135 282.714 60.4475 358.265 282.714  61.5341 356.029 282.714 87.111 340.498 282.714 79.2235 375.554 282.714  59.1619 360.88 282.714 83.6321 334.835 282.714 83.6623 334.865 282.714  65.0497 340.688 282.714 79.493 375.297 282.714 79.4094 375.379 282.714  88.2826 343.543 282.714 88.3469 343.696 282.714 68.1697 333.503 282.714  68.4242 333.155 282.714 62.5615 376.244 282.714 68.6857 332.794 282.714  69.0121 332.397 282.714 90.2553 356.587 282.714 85.3215 336.899 282.714  65.6763 339.367 282.714 65.7059 339.303 282.714 62.7648 352.49 282.714  62.8375 352.238 282.714 85.5912 368.362 282.714 86.53 366.67 282.714  67.2261 335.489 282.714 74.7937 379 282.714 57.8245 368.168 282.714  63.6861 347.221 282.714 63.689 347.147 282.714 60.5592 374.508 282.714  60.4323 374.374 282.714 82.3575 372.362 282.714 60.9886 357.178 282.714  80.4291 374.322 282.714 80.3844 374.371 282.714 72.359 379.866 282.714  72.0436 330.878 282.714 58.0542 363.759 282.714 58.1293 363.491 282.714  62.2671 354.114 282.714 62.2752 354.089 282.714 85.2592 368.97 282.714  85.0084 369.392 282.714 68.623 332.874 282.714 68.6495 332.838 282.714  77.59 376.805 282.714 88.4511 343.953 282.714 61.1028 375.025 282.714  60.9622 374.892 282.714 62.5513 353.213 282.714 62.6126 353.003 282.714  73.5969 379.557 282.714 73.3876 379.613 282.714 65.3566 340.047 282.714  64.9433 378.097 282.714 64.884 378.067 282.714 90.2346 356.902 282.714  59.1846 360.832 282.714 73.1802 330.703 282.714 58.232 363.115 282.714  63.693 346.664 282.714 82.6663 372.079 282.714 62.5083 353.388 282.714  62.5138 353.369 282.714 87.8538 364.883 282.714 64.0835 377.494 282.714  74.9761 330.612 282.714 64.6826 341.652 282.714 64.7689 341.412 282.714  66.2754 337.98 282.714 66.4422 337.546 282.714 77.4618 330.8 282.714  84.8329 336.198 282.714 84.1481 370.586 282.714 60.694 357.773 282.714  86.9524 340.105 282.714 84.2511 335.502 282.714 63.2438 350.814 282.714  85.893 337.853 282.714 65.3358 340.092 282.714 89.4781 346.724 282.714  89.4883 346.757 282.714 63.5707 348.971 282.714 67.0185 335.998 282.714  67.0259 335.98 282.714 70.0593 331.581 282.714 65.4762 378.333 282.714  65.2234 378.24 282.714 83.7253 334.931 282.714 78.0823 330.94 282.714  78.3216 331.004 282.714 87.4357 365.411 282.714 78.6172 331.082 282.714  86.4419 366.8 282.714 64.2797 342.944 282.714 65.6494 378.395 282.714  62.1571 354.509 282.714 62.1972 354.369 282.714 58.5603 371.999 282.714  58.508 371.897 282.714 63.6919 346.152 282.714 88.8071 344.828 282.714  89.4908 346.767 282.714 61.0378 357.078 282.714 79.9561 374.839 282.714  61.0619 357.03 282.714 61.2455 356.638 282.714 62.6935 352.716 282.714  67.0062 336.031 282.714 62.1349 354.597 282.714 79.5144 331.465 282.714  61.5257 356.049 282.714 68.3843 379.437 282.714 65.7266 339.257 282.714  89.0091 345.319 282.714 58.8806 361.488 282.714 84.6096 335.931 282.714  64.4403 377.749 282.714 64.3721 377.7 282.714 87.3527 341.12 282.714  90.183 351.865 282.714 63.2515 350.782 282.714 63.3848 350.199 282.714  62.7226 352.629 282.714 62.866 352.144 282.714 59.7318 359.707 282.714  57.8844 364.517 282.714 61.509 356.085 282.714 70.03 331.599 282.714  87.4769 341.436 282.714 84.0481 335.254 282.714 66.4471 337.534 282.714  66.4638 337.49 282.714 89.9127 359.475 282.714 89.8019 360.064 282.714  64.7013 377.935 282.714 75.8723 330.639 282.714 76.1294 330.65 282.714  59.688 373.596 282.714 59.5223 373.412 282.714 57.7427 367.157 282.714  89.033 345.378 282.714 59.0732 372.838 282.714 73.6082 330.651 282.714  89.6234 360.823 282.714 81.3883 373.299 282.714 ];
ring_pts_raw = reshape(ring_pts_raw, 3, []); 

connectivity_raw = [2 0 1 
2 2 3 
2 4 5 
2 6 7 
2 8 9 
2 10 11 
2 12 13 
2 14 15 
2 16 17 
2 18 16 
2 19 20 
2 21 22 
2 23 24 
2 25 26 
2 27 28 
2 29 30 
2 31 32 
2 33 34 
2 35 36 
2 37 38 
2 39 40 
2 41 42 
2 43 44 
2 9 45 
2 46 47 
2 48 49 
2 50 51 
2 52 53 
2 54 55 
2 56 57 
2 58 59 
2 60 61 
2 62 63 
2 64 65 
2 66 67 
2 68 69 
2 70 71 
2 72 73 
2 74 75 
2 76 77 
2 44 76 
2 78 79 
2 80 81 
2 82 83 
2 84 29 
2 85 86 
2 87 88 
2 89 90 
2 91 92 
2 93 94 
2 95 96 
2 97 98 
2 99 100 
2 101 102 
2 103 104 
2 105 106 
2 107 108 
2 109 110 
2 111 112 
2 113 114 
2 115 116 
2 117 118 
2 119 120 
2 121 122 
2 123 124 
2 98 125 
2 126 127 
2 128 129 
2 130 131 
2 132 18 
2 133 134 
2 135 136 
2 137 138 
2 139 140 
2 141 142 
2 143 144 
2 145 146 
2 147 148 
2 106 149 
2 127 150 
2 151 152 
2 153 135 
2 154 155 
2 156 157 
2 158 159 
2 160 161 
2 162 58 
2 163 164 
2 165 166 
2 167 168 
2 169 170 
2 55 171 
2 172 173 
2 174 175 
2 176 177 
2 178 179 
2 180 181 
2 182 183 
2 184 185 
2 186 187 
2 3 111 
2 188 74 
2 189 190 
2 191 192 
2 193 194 
2 181 176 
2 195 196 
2 197 137 
2 129 97 
2 198 199 
2 200 188 
2 185 115 
2 201 202 
2 171 0 
2 102 203 
2 204 205 
2 88 182 
2 206 191 
2 207 208 
2 209 210 
2 211 212 
2 213 214 
2 215 197 
2 216 37 
2 217 218 
2 219 220 
2 221 154 
2 222 223 
2 224 225 
2 226 227 
2 228 229 
2 230 231 
2 232 233 
2 234 213 
2 235 201 
2 236 237 
2 194 238 
2 239 167 
2 240 27 
2 241 101 
2 242 243 
2 244 245 
2 122 246 
2 247 248 
2 249 2 
2 250 251 
2 252 253 
2 254 255 
2 131 21 
2 11 256 
2 196 257 
2 253 46 
2 258 259 
2 69 249 
2 110 123 
2 260 261 
2 17 262 
2 263 60 
2 264 265 
2 266 267 
2 208 93 
2 268 68 
2 166 269 
2 270 271 
2 233 215 
2 272 156 
2 273 274 
2 45 54 
2 275 276 
2 277 278 
2 279 280 
2 281 282 
2 223 128 
2 283 284 
2 280 285 
2 286 287 
2 65 288 
2 289 290 
2 291 25 
2 292 293 
2 20 294 
2 51 295 
2 138 296 
2 231 228 
2 146 19 
2 190 297 
2 267 298 
2 256 299 
2 300 301 
2 302 85 
2 303 304 
2 305 12 
2 306 307 
2 308 309 
2 38 310 
2 248 311 
2 312 48 
2 75 313 
2 314 275 
2 313 315 
2 316 317 
2 318 319 
2 210 320 
2 282 321 
2 203 216 
2 96 322 
2 114 323 
2 324 325 
2 323 326 
2 320 327 
2 328 70 
2 108 186 
2 319 329 
2 330 331 
2 332 270 
2 61 6 
2 333 314 
2 334 335 
2 81 336 
2 337 207 
2 257 145 
2 220 338 
2 238 236 
2 339 340 
2 341 84 
2 225 4 
2 342 312 
2 136 343 
2 49 344 
2 157 50 
2 124 8 
2 345 346 
2 104 347 
2 348 333 
2 349 277 
2 350 263 
2 274 351 
2 352 353 
2 354 119 
2 355 356 
2 357 358 
2 359 360 
2 361 78 
2 362 363 
2 214 364 
2 365 264 
2 366 367 
2 368 369 
2 32 370 
2 183 184 
2 371 250 
2 372 339 
2 262 302 
2 294 373 
2 152 374 
2 288 198 
2 375 376 
2 83 328 
2 377 378 
2 315 375 
2 379 224 
2 92 380 
2 381 382 
2 363 99 
2 67 383 
2 384 95 
2 385 386 
2 387 388 
2 179 105 
2 389 390 
2 391 392 
2 393 260 
2 394 133 
2 395 396 
2 397 398 
2 399 400 
2 401 366 
2 402 403 
2 364 404 
2 309 139 
2 351 405 
2 322 406 
2 407 240 
2 408 244 
2 374 162 
2 356 350 
2 326 381 
2 237 409 
2 410 411 
2 155 87 
2 150 412 
2 413 43 
2 414 89 
2 415 416 
2 417 418 
2 419 306 
2 420 143 
2 317 421 
2 422 91 
2 202 316 
2 336 423 
2 73 180 
2 293 354 
2 13 222 
2 376 408 
2 424 121 
2 290 425 
2 423 349 
2 168 193 
2 426 72 
2 409 379 
2 311 268 
2 140 419 
2 276 163 
2 427 401 
2 212 230 
2 428 429 
2 7 393 
2 218 232 
2 77 172 
2 170 283 
2 430 200 
2 346 428 
2 431 432 
2 421 239 
2 433 33 
2 434 435 
2 353 436 
2 100 62 
2 437 438 
2 148 439 
2 438 440 
2 307 437 
2 441 334 
2 360 391 
2 229 217 
2 161 195 
2 269 442 
2 343 443 
2 444 445 
2 446 447 
2 448 189 
2 404 219 
2 405 39 
2 199 289 
2 358 394 
2 445 387 
2 245 448 
2 94 415 
2 134 449 
2 34 272 
2 429 450 
2 439 209 
2 259 417 
2 380 451 
2 390 235 
2 338 241 
2 36 252 
2 452 330 
2 149 242 
2 453 454 
2 398 455 
2 392 362 
2 456 431 
2 370 226 
2 227 389 
2 416 292 
2 251 441 
2 457 444 
2 329 130 
2 24 458 
2 177 80 
2 459 348 
2 112 460 
2 367 461 
2 327 371 
2 449 462 
2 373 332 
2 463 273 
2 246 464 
2 465 466 
2 278 467 
2 47 109 
2 468 211 
2 425 469 
2 378 279 
2 451 453 
2 301 470 
2 205 341 
2 435 402 
2 470 206 
2 455 471 
2 164 457 
2 369 472 
2 471 368 
2 347 422 
2 473 303 
2 472 64 
2 411 397 
2 57 463 
2 325 410 
2 125 474 
2 450 169 
2 464 420 
2 243 359 
2 475 459 
2 297 204 
2 476 433 
2 118 158 
2 477 318 
2 461 141 
2 436 478 
2 71 247 
2 53 103 
2 159 153 
2 467 477 
2 192 430 
2 479 480 
2 474 385 
2 412 147 
2 481 482 
2 396 377 
2 15 446 
2 403 483 
2 86 126 
2 173 361 
2 386 407 
2 142 258 
2 418 479 
2 480 107 
2 304 52 
2 299 395 
2 483 465 
2 484 485 
2 40 473 
2 486 487 
2 454 475 
2 432 372 
2 460 117 
2 447 221 
2 331 355 
2 400 66 
2 335 31 
2 30 165 
2 488 305 
2 489 345 
2 469 300 
2 42 490 
2 296 234 
2 485 308 
2 59 488 
2 90 484 
2 255 414 
2 298 291 
2 406 491 
2 491 174 
2 265 426 
2 175 254 
2 22 357 
2 321 492 
2 482 281 
2 490 14 
2 478 424 
2 26 468 
2 271 399 
2 295 384 
2 144 365 
2 466 413 
2 492 286 
2 443 434 
2 28 56 
2 287 132 
2 1 352 
2 5 493 
2 187 456 
2 487 41 
2 285 486 
2 442 337 
2 340 178 
2 344 266 
2 493 113 
2 116 151 
2 261 160 
2 382 452 
2 462 489 
2 120 427 
2 440 23 
2 383 82 
2 284 342 
2 310 481 
2 458 35 
2 79 10 
2 63 476 
2 388 324 ];

first_idx  = connectivity_raw(:,2); 
second_idx = connectivity_raw(:,3); 

valve_ring_pts = zeros(3,length(first_idx)); 
pt_idx = 0; 

current = first_idx(1); 
next = second_idx(1); 
complete = false; 
while true
    
    % add one to value of current when using as matlab index
    pt_idx = pt_idx + 1;
    valve_ring_pts(:,pt_idx) = ring_pts_raw(:, current + 1); 
    
    % search for the next index 
    current = first_idx(find(first_idx == next)); 
    next    = second_idx(find(first_idx == next)); 
    
    if isempty(current)
        error('Did not find a vertex with the correct index'); 
    end 
    
    % periodic return to the first point 
    if current == first_idx(1)
        complete = true; 
        break;
    end 
    
end 

if ~complete
    error('failed to find periodic cycle')
end 

skeleton.valve_ring_pts = valve_ring_pts; 

skeleton.n_ring_pts = size(skeleton.valve_ring_pts,2); 

if skeleton.n_ring_pts ~= pt_idx
    error('inconsistency in lengths')
end 

skeleton.ring_center = mean(skeleton.valve_ring_pts')'; 

radii = zeros(skeleton.n_ring_pts, 1); 
for j=1:skeleton.n_ring_pts
    radii(j) = norm(skeleton.valve_ring_pts(:,j) - skeleton.ring_center); 
end

skeleton.r = mean(radii); 

papillary_1 = false; 
if papillary_1
    % NB: points are in mm 
    papillary_raw = 0.1 * [86.1627 360.974 242.215 80.0723 359.194 240.021 76.3977 342.69 241.79 89.1854 357.894 240.64 82.0624 341.068 244.127 82.9452 362.81 242.147 78.759 341.052 243.556 85.1885 341.384 242.839]; 

    % this currently has got to be exactly 8 3d vectors 
    skeleton.papillary = reshape(papillary_raw, [3 8]); 

    % manually observed ordering, because paraview stores this in seemingly
    % random order 
    indices = [1 2 6 4 7 3 0 5] + 1; 
else 
    papillary_raw = 0.1 * [85.8746 361.433 242.218 77.8223 341.293 242.888 83.634 362.834 242.202 80.5244 341.195 244.174 82.8805 341.673 244.175 87.6973 359.791 242.049 82.0276 362.158 242.171 78.759 341.052 243.556]; 
    skeleton.papillary = reshape(papillary_raw, [3 8]); 
    indices = [6 1 7 3 4 5 0 2] + 1; 
end 


skeleton.papillary = skeleton.papillary(:,indices); 


if debug 
    fig = figure; 
    
    x = squeeze(skeleton.valve_ring_pts(1,:));
    y = squeeze(skeleton.valve_ring_pts(2,:));
    z = squeeze(skeleton.valve_ring_pts(3,:));
    plot3(x,y,z); 
    
    title('valve ring hcm d')
end 





