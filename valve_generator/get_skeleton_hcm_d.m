function skeleton = get_skeleton_hcm_d()
% 
% hardcoded patient specific MV skeleton
% 

% Copyright (c) 2019, Alexander D. Kaiser
% All rights reserved.
% 
% Redistribution and use in source and binary forms, with or without
% modification, are permitted provided that the following conditions are met:
% 
% 1. Redistributions of source code must retain the above copyright notice, this
%    list of conditions and the following disclaimer.
% 
% 2. Redistributions in binary form must reproduce the above copyright notice,
%    this list of conditions and the following disclaimer in the documentation
%    and/or other materials provided with the distribution.
% 
% 3. Neither the name of the copyright holder nor the names of its
%    contributors may be used to endorse or promote products derived from
%    this software without specific prior written permission.
% 
% THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
% AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
% IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
% DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
% FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
% DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
% SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
% CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
% OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
% OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

debug = true; 


% NB: points are in mm 
ring_pts_raw = 0.1 * [67.2421 335.823 282.003 67.3117 335.661 281.983 84.6483 369.476 271.756  84.6261 369.503 271.764 88.8771 348.901 271.381 88.9149 349.332 271.333  86.2739 367.136 271.202 86.114 367.408 271.254 57.9316 370.652 283.598  57.8891 370.502 283.628 85.3512 368.538 271.511 85.2018 368.754 271.562  84.9774 336.603 274.027 85.0788 336.801 273.967 84.1733 335.235 274.487  84.2008 335.275 274.471 69.2192 380.132 277.861 68.9751 380.131 277.97  76.699 377.317 274.729 76.4108 377.45 274.848 86.589 340.425 273.026  86.7428 340.779 272.932 86.8334 341.072 272.87 86.9044 341.303 272.821  83.9588 370.316 272.002 83.8399 370.456 272.045 82.3501 372.358 272.57  82.2612 372.474 272.601 78.3465 376.441 274.057 78.1707 376.557 274.128  83.6573 370.68 272.11 83.5027 370.872 272.165 57.3944 365.414 284.223  57.4014 365.343 284.225 79.4366 331.082 276.907 79.5046 331.104 276.875  66.7338 379.499 279.017 66.608 379.445 279.077 63.8262 344.531 282.887  63.9988 343.893 282.857 70.7674 331.449 280.75 71.1733 331.29 280.581  81.7687 373.119 272.774 81.4972 373.462 272.87 88.4011 359.114 270.843  88.3895 359.446 270.823 86.2636 339.543 273.236 86.2818 339.585 273.225  57.8094 370.072 283.695 57.7333 369.69 283.757 70.5511 379.861 277.286  70.1472 379.972 277.459 81.4656 373.502 272.881 81.176 373.874 272.983  83.0472 371.448 272.326 82.9196 371.615 272.371 80.6095 374.525 273.188  80.5531 374.587 273.209 57.5132 364.617 284.229 57.5759 364.318 284.223  59.3865 373.253 282.757 59.2375 373.062 282.838 80.3292 331.495 276.478  80.388 331.534 276.449 64.8657 341.17 282.67 64.8809 341.13 282.666  61.9596 354.81 282.965 62.0911 354.512 282.928 58.1691 362.482 284.093  58.216 362.373 284.08 57.3661 365.92 284.198 57.3692 365.767 284.208  87.8436 345.251 272.111 87.8797 345.38 272.086 71.2271 379.636 277.001  71.21 379.643 277.008 66.4316 379.367 279.162 66.2899 379.302 279.23  59.1625 360.378 283.804 59.1891 360.325 283.796 80.8229 331.809 276.234  81.0049 331.929 276.144 87.8939 363.289 270.762 87.785 363.707 270.78  62.8891 352.006 282.756 62.9584 351.773 282.742 63.6471 348.186 282.698  63.6585 348.037 282.704 58.1301 371.21 283.468 58.0167 370.943 283.538  82.2735 333.006 275.499 82.3187 333.051 275.475 88.4188 358.637 270.87  88.4117 358.856 270.857 77.0548 377.145 274.582 76.863 377.239 274.661  77.3969 330.661 277.848 77.574 330.681 277.768 63.8235 344.542 282.888  60.7755 357.226 283.316 60.9347 356.915 283.267 85.5275 337.773 273.695  85.7331 338.238 273.569 69.667 380.066 277.666 69.317 380.12 277.818  87.5104 343.647 272.378 87.5326 343.774 272.359 62.2628 376.416 281.24  62.0813 376.24 281.334 87.3084 342.647 272.542 87.3975 343.015 272.475  76.4064 330.618 278.294 76.8191 330.632 278.108 59.8178 359.098 283.605  59.995 358.752 283.552 71.8423 379.405 276.743 71.6443 379.479 276.826  65.2187 340.38 282.571 65.3306 340.157 282.537 73.1558 330.803 279.731  73.4321 330.758 279.611 59.599 359.531 283.671 59.7268 359.276 283.633  85.9429 338.764 273.437 85.9979 338.905 273.402 61.0219 375.132 281.889  60.9352 375.036 281.934 88.8298 351.895 271.182 88.8092 352.168 271.171  71.4667 331.173 280.458 71.5791 331.131 280.411 67.3916 335.481 281.961  67.5914 335.03 281.905 64.8347 378.519 279.937 64.775 378.479 279.967  75.3489 377.917 275.287 75.1621 377.998 275.365 60.9663 356.86 283.257  61.0367 356.724 283.236 57.4646 367.998 284.002 57.4108 367.43 284.067  88.9153 349.341 271.332 81.2042 332.078 276.044 81.3226 332.181 275.984  68.5655 380.106 278.155 65.9046 338.988 282.367 66.0464 338.695 282.325  88.8325 351.855 271.184 58.4119 361.915 284.026 58.4999 361.723 284.001  88.5299 355.892 271.022 88.5155 356.133 271.011 69.5099 332.255 281.252  69.7858 332.049 281.144 72.414 379.178 276.505 72.0569 379.318 276.654  86.3919 366.954 271.163 57.4372 365.111 284.226 77.3387 377.001 274.466  81.5971 332.41 275.844 87.4431 364.73 270.857 87.2901 365.153 270.895  81.6672 332.47 275.809 81.9338 332.692 275.673 64.8958 341.094 282.662  84.3681 369.817 271.856 84.932 369.117 271.656 84.7015 369.41 271.737  83.7895 370.515 272.063 84.9211 336.498 274.06 86.7399 366.311 271.055  86.4695 366.815 271.139 66.8075 336.89 282.118 66.8618 336.751 282.104  65.4889 378.901 279.617 65.2196 378.747 279.749 87.2888 342.567 272.556  83.2102 371.236 272.269 82.061 372.734 272.672 82.6336 371.988 272.471  82.5765 372.065 272.491 86.9305 341.373 272.804 87.0088 341.583 272.754  87.6557 344.414 272.257 87.7342 344.781 272.195 64.0833 343.602 282.841  64.1256 343.45 282.833 86.4236 339.971 273.133 86.4982 340.173 273.085  86.7631 340.844 272.918 58.3667 371.849 283.316 58.2732 371.592 283.376  81.4744 373.491 272.878 80.446 374.706 273.248 80.2398 374.924 273.324  80.8729 374.232 273.092 74.2563 378.39 275.74 74.2143 378.409 275.758  82.6558 371.959 272.463 85.0261 369.008 271.622 87.4218 343.122 272.456  79.5176 375.58 273.598 79.4865 375.607 273.61 81.867 372.994 272.739  83.4404 370.952 272.187 87.1894 342.192 272.628 81.0447 374.042 273.029  85.348 337.355 273.806 85.4328 337.56 273.753 59.0887 372.892 282.917  63.6281 348.497 282.684 70.1923 331.738 280.986 70.5496 331.546 280.84  57.4679 368.027 283.998 57.4659 368.011 284 63.6761 345.808 282.86  63.6808 345.639 282.871 67.1094 336.135 282.039 74.6702 378.205 275.569  74.3271 378.36 275.711 78.8305 376.112 273.866 78.7737 376.156 273.888  87.4383 343.202 272.443 62.7301 376.853 280.999 62.4951 376.632 281.121  64.9506 378.589 279.88 63.5239 349.497 282.657 63.5714 349.105 282.665  83.27 334.045 274.977 83.3506 334.136 274.935 88.6616 353.9 271.11  88.6464 354.165 271.097 63.0654 351.421 282.72 63.1422 351.146 282.706  74.9832 378.077 275.439 80.1315 375.04 273.364 63.6218 348.557 282.682  88.5768 355.156 271.055 88.5561 355.426 271.045 65.5398 378.926 279.593  59.4715 359.777 283.71 63.741 345.178 282.878 63.7458 345.138 282.878  61.9475 376.108 281.404 61.7505 375.892 281.507 63.4876 349.723 282.656  60.4445 357.88 283.415 60.5513 357.667 283.383 87.4292 343.149 272.451  57.4909 364.769 284.227 88.0121 345.85 271.992 68.4746 380.089 278.197  68.1315 380.013 278.356 67.7159 379.916 278.548 67.6615 379.893 278.574  88.5097 356.458 270.99 64.3906 342.533 282.782 64.4245 342.417 282.776  79.5573 375.545 273.583 86.0192 338.963 273.388 57.3592 366.421 284.165  75.2371 330.626 278.815 75.4953 330.612 278.701 64.2958 378.149 280.205  64.083 377.995 280.311 57.7202 369.617 283.768 57.6102 368.982 283.864  88.9198 350.658 271.233 88.9036 350.928 271.22 63.6781 346.572 282.803  63.68 346.318 282.821 87.7623 363.809 270.783 88.7558 352.693 271.157  75.9992 377.626 275.018 75.721 377.75 275.133 72.9961 378.934 276.263  72.9039 378.973 276.301 73.8313 378.575 275.916 73.4352 378.746 276.081  88.6652 347.835 271.554 88.7291 348.095 271.507 66.1955 338.39 282.281  66.3927 337.9 282.229 66.6819 337.195 282.152 61.5067 375.635 281.635  61.4327 375.555 281.674 84.2353 335.33 274.452 84.7067 336.099 274.185  72.4089 330.933 280.055 72.5748 330.899 279.984 82.0111 332.759 275.634  59.37 359.971 283.741 57.729 369.669 283.761 88.748 352.778 271.154  57.6621 363.942 284.212 57.7383 363.696 284.196 72.2312 330.969 280.132  85.6418 368.148 271.41 85.4586 368.382 271.475 63.2588 377.329 280.728  63.1989 377.28 280.759 57.3626 366.613 284.149 79.5829 331.139 276.837  80.0655 331.339 276.607 88.3001 360.523 270.784 88.2896 360.662 270.779  67.4063 379.781 278.696 88.3286 360.268 270.79 66.9187 379.578 278.929  64.2024 343.177 282.819 68.0489 379.996 278.394 67.6779 334.842 281.88  68.019 334.195 281.775 85.8125 338.442 273.519 88.377 359.706 270.81  88.3365 360.195 270.792 64.4531 378.259 280.127 64.5419 342.024 282.752  64.5447 342.016 282.751 76.123 330.613 278.421 76.1956 330.613 278.388  60.3181 374.327 282.262 59.9702 373.938 282.446 57.3823 367.122 284.103  57.3699 366.967 284.12 82.6257 333.354 275.316 82.7425 333.469 275.255  59.9646 373.931 282.449 75.0017 330.632 278.92 62.9982 351.641 282.734  63.2201 350.912 282.688 63.2344 350.866 282.685 60.2207 358.315 283.483  58.8419 361.023 283.9 58.9029 360.897 283.882 88.8879 351.201 271.207  87.9764 362.922 270.752 88.2465 346.539 271.837 88.2963 346.688 271.803  63.7301 345.271 282.876 88.9324 349.968 271.278 88.9324 350.327 271.252  63.3708 350.3 282.666 63.3859 350.237 282.664 66.1668 338.449 282.289  85.2598 337.167 273.859 72.8436 330.849 279.867 88.928 349.76 271.295  72.0009 331.023 280.231 62.4131 376.558 281.163 57.5912 368.863 283.881  88.399 346.997 271.735 88.4253 347.077 271.717 63.6653 347.699 282.726  87.4522 364.705 270.855 87.4471 364.72 270.856 63.6687 347.627 282.73  69.7879 380.045 277.614 71.6848 331.095 280.367 62.4423 353.523 282.844  62.464 353.454 282.839 88.7436 352.844 271.151 65.8538 379.066 279.442  73.6589 330.729 279.512 69.4223 332.321 281.287 66.3951 337.894 282.228  77.8909 330.724 277.623 76.9036 330.634 278.071 77.3116 330.652 277.887  63.4156 377.462 280.649 88.0893 362.3 270.748 88.0288 362.644 270.749  76.0765 377.593 274.986 76.0264 377.613 275.007 58.8108 372.49 283.07  58.7987 372.474 283.077 58.1416 362.546 284.1 63.8006 344.701 282.886  72.5327 379.131 276.455 87.8169 345.14 272.131 88.1294 346.199 271.914  88.2184 346.456 271.855 67.1891 379.699 278.799 57.5139 368.36 283.953  88.5818 355.028 271.063 58.621 361.471 283.965 58.6935 361.323 283.944  68.0467 334.143 281.767 61.5961 355.591 283.069 61.7022 355.376 283.038  67.0409 336.308 282.057 78.039 376.625 274.181 61.7792 355.214 283.015  66.1652 379.24 279.29 65.0584 340.699 282.619 63.8504 377.822 280.428  63.7426 377.737 280.482 77.7272 376.797 274.308 65.5667 339.681 282.467  65.7206 339.373 282.421 62.7552 352.473 282.781 62.8186 352.264 282.768  86.8457 366.129 271.021 63.6751 347.234 282.756 63.6773 347.139 282.762  70.6412 379.833 277.248 87.0824 365.605 270.954 86.9493 365.895 270.992  68.1439 333.968 281.736 68.3348 333.629 281.676 60.5461 374.575 282.142  60.3808 374.389 282.23 88.4909 356.71 270.979 78.5226 330.829 277.333  78.8356 330.899 277.189 87.6336 364.214 270.81 88.47 357.302 270.945  88.456 357.53 270.935 73.7415 330.723 279.476 61.1394 356.516 283.205  57.852 370.303 283.659 62.2192 354.101 282.901 62.2243 354.086 282.9  58.4165 371.918 283.288 82.4604 333.187 275.402 62.5497 353.122 282.825  62.5986 352.964 282.815 87.6019 344.159 272.299 87.621 344.263 272.283  85.9478 367.657 271.31 85.7574 367.953 271.373 84.8289 336.321 274.114  61.1688 375.284 281.812 63.6727 346.703 282.796 73.8654 378.56 275.902  57.8004 363.489 284.183 57.8895 363.195 284.165 62.479 353.407 282.836  62.4813 353.399 282.835 64.6815 341.654 282.717 64.7687 341.42 282.695  57.6219 364.073 284.22 78.1391 330.755 277.51 78.3172 330.78 277.429  71.1775 379.654 277.022 79.5329 331.114 276.861 72.9782 330.829 279.809  77.4924 376.922 274.403 63.2533 350.805 282.682 88.7952 348.451 271.451  88.8435 348.712 271.41 87.1184 341.888 272.682 88.7037 353.356 271.131  58.2244 371.463 283.408 70.6386 331.499 280.804 88.08 346.053 271.947  88.1166 362.111 270.749 65.4124 339.995 282.513 61.2099 356.378 283.184  63.5857 348.989 282.667 82.9571 333.685 275.143 88.0044 362.819 270.747  60.7567 374.82 282.03 60.666 374.712 282.078 60.1669 358.422 283.499  68.5305 333.361 281.608 68.6801 333.163 281.556 75.6181 330.61 278.646  70.1453 331.773 281.004 78.7384 376.181 273.902 80.4303 331.56 276.428  69.0415 332.709 281.428 69.3168 332.422 281.326 88.8668 351.464 271.197  88.4552 357.766 270.918 88.4606 357.935 270.903 84.2587 369.963 271.894  64.2672 342.948 282.807 63.6717 346.098 282.841 87.7361 363.886 270.789  62.1248 354.428 282.919 83.7617 334.641 274.714 83.9287 334.871 274.622  62.8275 376.942 280.949 73.1902 378.854 276.182 73.0633 378.907 276.235  74.2396 330.678 279.257 74.506 330.651 279.14 57.925 363.085 284.157  62.6671 352.733 282.801 88.683 353.617 271.121 58.0651 362.74 284.12  88.1992 361.525 270.756 88.1787 361.69 270.753 74.007 330.703 279.359  88.4462 358.415 270.874 61.4314 355.947 283.117 83.6544 334.503 274.772  88.2504 361.113 270.763 88.2264 361.281 270.761 59.7728 359.184 283.619  63.2637 350.763 282.68 63.4158 350.138 282.658 62.7208 352.581 282.789  62.8451 352.18 282.763 74.7352 330.64 279.038 65.868 339.065 282.378  88.2694 360.886 270.771 83.4017 334.199 274.907 66.5486 337.531 282.187  68.9351 332.843 281.466 70.9381 379.734 277.123 66.4 337.882 282.227  88.6146 354.62 271.078 59.6793 373.59 282.602 59.5581 373.453 282.666  88.5446 347.444 271.637 88.4803 356.926 270.968 87.1687 365.419 270.929  79.0568 330.965 277.085];
ring_pts_raw = reshape(ring_pts_raw, 3, []); 

connectivity_raw = [2 0 1 
2 2 3 
2 4 5 
2 6 7 
2 8 9 
2 10 11 
2 12 13 
2 14 15 
2 16 17 
2 18 19 
2 20 21 
2 22 23 
2 24 25 
2 26 27 
2 28 29 
2 30 31 
2 32 33 
2 34 35 
2 36 37 
2 38 39 
2 40 41 
2 42 43 
2 44 45 
2 46 47 
2 48 49 
2 50 51 
2 52 53 
2 54 55 
2 56 57 
2 58 59 
2 60 61 
2 62 63 
2 64 65 
2 66 67 
2 68 69 
2 70 71 
2 72 73 
2 71 32 
2 74 75 
2 76 77 
2 78 79 
2 80 81 
2 82 83 
2 84 85 
2 86 87 
2 88 89 
2 90 91 
2 92 93 
2 94 95 
2 96 97 
2 98 38 
2 99 100 
2 101 102 
2 103 104 
2 105 106 
2 107 108 
2 109 110 
2 111 112 
2 113 114 
2 115 116 
2 117 118 
2 119 120 
2 121 122 
2 123 124 
2 125 126 
2 127 128 
2 129 130 
2 131 132 
2 133 134 
2 135 136 
2 137 138 
2 139 140 
2 5 141 
2 142 143 
2 17 144 
2 145 146 
2 147 127 
2 148 149 
2 150 151 
2 152 153 
2 154 155 
2 156 6 
2 33 157 
2 158 94 
2 143 159 
2 160 161 
2 162 163 
2 65 164 
2 3 165 
2 166 167 
2 25 168 
2 169 12 
2 170 171 
2 172 173 
2 174 175 
2 176 109 
2 177 54 
2 27 178 
2 179 180 
2 181 182 
2 183 184 
2 185 186 
2 187 188 
2 189 22 
2 190 191 
2 192 52 
2 193 194 
2 195 56 
2 196 197 
2 198 179 
2 199 166 
2 110 200 
2 201 202 
2 43 192 
2 178 203 
2 204 177 
2 205 176 
2 206 195 
2 207 208 
2 61 209 
2 168 30 
2 210 86 
2 211 212 
2 213 214 
2 215 216 
2 217 0 
2 1 131 
2 218 219 
2 220 221 
2 222 105 
2 223 224 
2 225 133 
2 226 227 
2 228 229 
2 230 231 
2 69 148 
2 232 233 
2 234 218 
2 194 235 
2 236 210 
2 237 238 
2 239 174 
2 240 121 
2 241 242 
2 243 244 
2 23 181 
2 245 226 
2 246 247 
2 248 222 
2 157 249 
2 73 250 
2 251 252 
2 253 254 
2 151 255 
2 188 20 
2 256 257 
2 258 201 
2 259 46 
2 260 70 
2 261 262 
2 263 264 
2 265 266 
2 267 268 
2 269 270 
2 83 271 
2 128 272 
2 273 274 
2 275 276 
2 277 278 
2 279 280 
2 281 282 
2 283 172 
2 284 285 
2 286 287 
2 288 289 
2 290 90 
2 291 240 
2 49 292 
2 171 156 
2 272 293 
2 294 295 
2 296 288 
2 297 298 
2 299 300 
2 301 260 
2 302 303 
2 304 305 
2 254 306 
2 307 304 
2 308 36 
2 186 309 
2 252 310 
2 311 312 
2 313 123 
2 314 315 
2 134 316 
2 317 318 
2 319 320 
2 321 322 
2 323 324 
2 325 326 
2 322 327 
2 328 261 
2 85 329 
2 330 331 
2 332 246 
2 333 334 
2 268 335 
2 336 82 
2 337 338 
2 216 339 
2 340 341 
2 159 162 
2 342 343 
2 89 8 
2 146 344 
2 13 345 
2 289 346 
2 79 291 
2 141 347 
2 348 296 
2 224 349 
2 266 350 
2 351 352 
2 87 353 
2 354 355 
2 353 356 
2 357 103 
2 130 358 
2 359 360 
2 293 361 
2 345 207 
2 362 239 
2 120 363 
2 364 152 
2 282 365 
2 97 366 
2 367 368 
2 369 299 
2 370 371 
2 372 373 
2 374 375 
2 376 68 
2 377 98 
2 276 378 
2 379 72 
2 380 381 
2 45 314 
2 382 308 
2 350 383 
2 384 237 
2 385 386 
2 312 387 
2 388 389 
2 173 390 
2 29 391 
2 392 66 
2 77 393 
2 394 117 
2 395 396 
2 389 392 
2 391 397 
2 163 290 
2 303 62 
2 132 311 
2 202 220 
2 398 399 
2 344 281 
2 400 401 
2 402 170 
2 368 96 
2 329 232 
2 403 404 
2 405 50 
2 406 407 
2 408 409 
2 410 411 
2 255 412 
2 356 403 
2 413 414 
2 415 354 
2 416 417 
2 41 129 
2 100 137 
2 93 44 
2 363 418 
2 138 419 
2 386 333 
2 238 150 
2 420 48 
2 421 422 
2 375 423 
2 387 408 
2 91 424 
2 425 426 
2 427 428 
2 429 430 
2 184 379 
2 287 431 
2 347 340 
2 338 351 
2 432 125 
2 433 269 
2 434 277 
2 435 436 
2 396 369 
2 437 438 
2 334 78 
2 324 301 
2 439 440 
2 59 441 
2 442 443 
2 75 444 
2 35 445 
2 346 446 
2 9 420 
2 164 394 
2 366 442 
2 447 158 
2 404 433 
2 140 323 
2 200 248 
2 331 448 
2 449 450 
2 451 205 
2 298 10 
2 361 452 
2 453 88 
2 175 225 
2 454 40 
2 250 455 
2 456 370 
2 457 398 
2 219 196 
2 116 74 
2 108 243 
2 341 267 
2 393 362 
2 419 458 
2 349 107 
2 102 313 
2 459 236 
2 326 460 
2 212 454 
2 280 449 
2 155 115 
2 371 461 
2 292 265 
2 462 463 
2 114 464 
2 95 18 
2 465 466 
2 463 410 
2 124 259 
2 244 284 
2 262 467 
2 468 211 
2 221 469 
2 63 470 
2 7 429 
2 471 472 
2 473 147 
2 474 475 
2 165 476 
2 81 142 
2 309 477 
2 106 427 
2 478 215 
2 441 294 
2 233 330 
2 271 479 
2 264 395 
2 423 190 
2 480 421 
2 270 478 
2 318 439 
2 481 482 
2 300 483 
2 484 485 
2 310 253 
2 486 487 
2 436 488 
2 306 382 
2 426 489 
2 355 160 
2 452 490 
2 488 491 
2 51 357 
2 440 64 
2 492 493 
2 494 486 
2 475 495 
2 455 380 
2 496 388 
2 316 263 
2 390 217 
2 497 481 
2 498 499 
2 479 415 
2 122 500 
2 464 332 
2 448 501 
2 411 321 
2 500 113 
2 343 502 
2 235 258 
2 242 377 
2 47 187 
2 21 189 
2 182 451 
2 180 26 
2 53 206 
2 203 42 
2 57 193 
2 502 245 
2 167 2 
2 31 204 
2 476 24 
2 55 198 
2 11 199 
2 489 503 
2 401 504 
2 67 480 
2 503 400 
2 472 364 
2 504 84 
2 438 425 
2 483 223 
2 360 437 
2 381 337 
2 136 234 
2 458 496 
2 397 447 
2 339 241 
2 112 367 
2 505 328 
2 257 317 
2 249 58 
2 274 135 
2 506 145 
2 358 348 
2 446 119 
2 305 507 
2 37 76 
2 460 228 
2 508 497 
2 418 494 
2 467 319 
2 227 459 
2 417 474 
2 509 283 
2 469 28 
2 247 99 
2 335 473 
2 461 336 
2 399 506 
2 466 510 
2 511 405 
2 491 376 
2 407 402 
2 512 509 
2 104 16 
2 424 325 
2 513 384 
2 443 413 
2 295 435 
2 493 456 
2 373 273 
2 378 154 
2 229 508 
2 430 297 
2 153 468 
2 514 515 
2 516 279 
2 485 275 
2 412 517 
2 39 185 
2 501 342 
2 450 4 
2 191 453 
2 383 213 
2 490 230 
2 352 516 
2 15 286 
2 499 492 
2 144 251 
2 126 462 
2 482 14 
2 19 372 
2 209 374 
2 487 505 
2 278 484 
2 315 307 
2 208 101 
2 231 513 
2 517 416 
2 507 498 
2 365 512 
2 161 518 
2 431 169 
2 285 432 
2 320 111 
2 515 60 
2 327 514 
2 414 519 
2 444 511 
2 477 256 
2 409 465 
2 510 471 
2 428 183 
2 445 302 
2 495 92 
2 118 457 
2 214 139 
2 518 406 
2 470 80 
2 197 434 
2 519 34 
2 149 385 
2 422 359   ];

first_idx  = connectivity_raw(:,2); 
second_idx = connectivity_raw(:,3); 

valve_ring_pts = zeros(3,length(first_idx)); 
pt_idx = 0; 

current = first_idx(1); 
next = second_idx(1); 
complete = false; 
while true
    
    % add one to value of current when using as matlab index
    pt_idx = pt_idx + 1;
    valve_ring_pts(:,pt_idx) = ring_pts_raw(:, current + 1); 
    
    % search for the next index 
    current = first_idx(find(first_idx == next)); 
    next    = second_idx(find(first_idx == next)); 
    
    if isempty(current)
        error('Did not find a vertex with the correct index'); 
    end 
    
    % periodic return to the first point 
    if current == first_idx(1)
        complete = true; 
        break;
    end 
    
end 

if ~complete
    error('failed to find periodic cycle')
end 

skeleton.valve_ring_pts = valve_ring_pts; 

skeleton.n_ring_pts = size(skeleton.valve_ring_pts,2); 

if skeleton.n_ring_pts ~= pt_idx
    error('inconsistency in lengths')
end 

skeleton.ring_center = mean(skeleton.valve_ring_pts')'; 

radii = zeros(skeleton.n_ring_pts, 1); 
for j=1:skeleton.n_ring_pts
    radii(j) = norm(skeleton.valve_ring_pts(:,j) - skeleton.ring_center); 
end

skeleton.r = mean(radii); 

papillary_1 = false; 
if papillary_1
    % NB: points are in mm 
    papillary_raw = 0.1 * [86.1627 360.974 242.215 80.0723 359.194 240.021 76.3977 342.69 241.79 89.1854 357.894 240.64 82.0624 341.068 244.127 82.9452 362.81 242.147 78.759 341.052 243.556 85.1885 341.384 242.839]; 

    % this currently has got to be exactly 8 3d vectors 
    skeleton.papillary = reshape(papillary_raw, [3 8]); 

    % manually observed ordering, because paraview stores this in seemingly
    % random order 
    indices = [1 2 6 4 7 3 0 5] + 1; 
else 
    papillary_raw = 0.1 * [85.8746 361.433 242.218 77.8223 341.293 242.888 83.634 362.834 242.202 80.5244 341.195 244.174 82.8805 341.673 244.175 87.6973 359.791 242.049 82.0276 362.158 242.171 78.759 341.052 243.556]; 
    skeleton.papillary = reshape(papillary_raw, [3 8]); 
    indices = [6 1 7 3 4 5 0 2] + 1; 
end 


skeleton.papillary = skeleton.papillary(:,indices); 


if debug 
    fig = figure; 
    
    x = squeeze(skeleton.valve_ring_pts(1,:));
    y = squeeze(skeleton.valve_ring_pts(2,:));
    z = squeeze(skeleton.valve_ring_pts(3,:));
    plot3(x,y,z); 
    
    title('valve ring hcm d')
end 





