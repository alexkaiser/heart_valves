function skeleton = valve_points_diastole_mcqueen_1(tip_radius, output)
% 
% Takes a center, radius and papillary coords 
% Moves center to origin 
% Takes papillary tips in rigid manner
% 

% Copyright (c) 2019, Alexander D. Kaiser
% All rights reserved.
% 
% Redistribution and use in source and binary forms, with or without
% modification, are permitted provided that the following conditions are met:
% 
% 1. Redistributions of source code must retain the above copyright notice, this
%    list of conditions and the following disclaimer.
% 
% 2. Redistributions in binary form must reproduce the above copyright notice,
%    this list of conditions and the following disclaimer in the documentation
%    and/or other materials provided with the distribution.
% 
% 3. Neither the name of the copyright holder nor the names of its
%    contributors may be used to endorse or promote products derived from
%    this software without specific prior written permission.
% 
% THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
% AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
% IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
% DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
% FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
% DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
% SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
% CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
% OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
% OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

if ~exist('output', 'var')
    output = false; 
end 


ring_pts = [5.3287165861788353        2.5174172685383036       -1.9413166424732098     
   5.3195037114923593        2.5216187757966724       -1.9674642922163743     
   5.3099864239865440        2.5254403392354163       -1.9935613972244988     
   5.3001681568886809        2.5288806237105925       -2.0195997558990668     
   5.2900515804866544        2.5319388662828048       -2.0455717388461103     
   5.2796397465380522        2.5346137318081068       -2.0714691444671134     
   5.2689360882701592        2.5369044573471031       -2.0972841526332582     
   5.2579436574405634        2.5388106614300936       -2.1230089432157273     
   5.2466658872765564        2.5403315811176830       -2.1486358868205526     
   5.2351062110054158        2.5414666442053244       -2.1741567818492173     
   5.2232680618544336        2.5422156599581660       -2.1995641896426035     
   5.2111548730508872        2.5425782469065128       -2.2248500993370435     
   5.1987708407614690        2.5425545957852105       -2.2500070722734185     
   5.1861193982134637        2.5421443251245623       -2.2750270975880618     
   5.1732047415735423        2.5413478163942669       -2.2999029273567033     
   5.1600303040690036        2.5401652603291742       -2.3246269321853745     
   5.1466002818665260        2.5385970383989802       -2.3491912919452580     
   5.1329188711327873        2.5366435320733851       -2.3735887587120841     
   5.1189902680344801        2.5343055042917859       -2.3978118938267339     
   5.1048182872685786        2.5315833365238793       -2.4218532586300872     
   5.0904078879411614        2.5284781731787627       -2.4457056051978752     
   5.0757632662189209        2.5249909679306812       -2.4693614948709781     
   5.0608882367988386        2.5211226744538804       -2.4928138704599752     
   5.0457885217263865        2.5168744371574556       -2.5160556747754463     
   5.0304675542288564        2.5122475911853526       -2.5390796598931207     
   5.0149306748820166        2.5072434716815151       -2.5618787686235787     
   4.9991824613222562        2.5018637952595846       -2.5844461345122474     
   4.9832278726556467        2.4961098970635076       -2.6067750818394058     
   4.9670714865185772        2.4899838751766241       -2.6288583626807833     
   4.9507182620171264        2.4834874462125773       -2.6506896827863566     
   4.9341735397270696        2.4766225175198597       -2.6722621757015532     
   4.9174415158150921        2.4693913779166605       -2.6935693564415009     
   4.9005282937963628        2.4617959347514740       -2.7146047400213260     
   4.8834384513072706        2.4538386675773385       -2.7353618414561560     
   4.8661773289235839        2.4455220559472934       -2.7558341757611173     
   4.8487502672210923        2.4368485794143799       -2.7760160208907338     
   4.8311622253058601        2.4278209082664848       -2.7959007011252832     
   4.8134193066930777        2.4184415220566491       -2.8154823036844401     
   4.7955260890191127        2.4087138540121584       -2.8347551065227283     
   4.7774882943294514        2.3986401929512047       -2.8537130061249729     
   4.7593116446695660        2.3882241628359191       -2.8723502804456977     
   4.7410014806152319        2.3774686246890440       -2.8906612074394267     
   4.7225631427422314        2.3663770117378622       -2.9086402557955324     
   4.7040027345657407        2.3549525664748119       -2.9262818942033881     
   4.6853259781312318        2.3431989128620270       -2.9435809728220650     
   4.6665378325447762        2.3311194841267939       -2.9605319603409361     
   4.6476447827912679        2.3187179042312476       -2.9771297069190732     
   4.6286521694464682        2.3059983693420705       -2.9933694441852454     
   4.6095657145558562        2.2929643126865473       -3.0092458315636748     
   4.5903915216346078        2.2796197396965141       -3.0247542914179810     
   4.5711353127282024        2.2659690372735000       -3.0398900553769335     
   4.5518031913518087        2.2520160201144899       -3.0546483550693022     
   4.5324004980812092        2.2377650751210174       -3.0690249943284038     
   4.5129333364315798        2.2232205891946117       -3.0830152047830093     
   4.4934081913877861        2.2083869492368047       -3.0966151717361337     
   4.4738300220559140        2.1932685421491307       -3.1098203175513959     
   4.4542056948905326        2.1778703270376676       -3.1226270182666616     
   4.4345409319371214        2.1621965000690970       -3.1350310777152477     
   4.4148414552411523        2.1462524018191980       -3.1470288719350195     
   4.3951133683178085        2.1300424191895031       -3.1586165862289928     
   4.3753627746822517        2.1135717020209386       -3.1697907873698816     
   4.3555953963799610        2.0968452094195866       -3.1805482328652497     
   4.3358180998655200        2.0798679004915241       -3.1908854894878109     
   4.3160358442449933        2.0626453065473811       -3.2007993147451286     
   4.2962554959729644        2.0451823866932326       -3.2102868476144653     
   4.2764823956252016        2.0274846722397104       -3.2193452270730827     
   4.2567230281865776        2.0095573130277398       -3.2279714013633933     
   4.2369831157025786        1.9914058403679498       -3.2361630816672058     
   4.2172691431580702        1.9730357855709659       -3.2439175976966332     
   4.1975864511288350        1.9544528706822657       -3.2512326606334829     
   4.1779419060694423        1.9356626270124746       -3.2581059816595657     
   4.1583404670859636        1.9166709673419202       -3.2645356534263898     
   4.1387890006329826        1.8974834229812299       -3.2705193871157636     
   4.1192928472862747        1.8781059067107257       -3.2760552753791954     
   4.0998581105610086        1.8585443313107355       -3.2811421738075897     
   4.0804908939723603        1.8388048002964332       -3.2857785565221542     
   4.0611969195658091        1.8188930357132964       -3.2899621347046963     
   4.0419819093868270        1.7988153318113476       -3.2936925268855193     
   4.0228523484203009        1.7785777921057626       -3.2969682071858282     
   4.0038135772419920        1.7581867108465641       -3.2997884126662278     
   3.9848713178973796        1.7376478100792294       -3.3021516174479233     
   3.9660312924319427        1.7169677655234796       -3.3040582030006123     
   3.9472996043608646        1.6961528714293390       -3.3055066434455034     
   3.9286819757296030        1.6752092313119835       -3.3064969387825940     
   3.9101837471139547        1.6541435208911341       -3.3070287075421883     
   3.8918106405593846        1.6329618436819651       -3.3071015682545859     
   3.8735683781113721        1.6116708754042008       -3.3067159023894863     
   3.8554623003456925        1.5902771010427124       -3.3058717099468886     
   3.8374981293078250        1.5687869102149499       -3.3045689909267937     
   3.8196815870432417        1.5472068832732084       -3.3028081267988991     
   3.8020172511883317        1.5255436005697884       -3.3005902619723004     
   3.7845116067279605        1.5038037378244109       -3.2979153964469985     
   3.7671688498288134        1.4819938753893744       -3.2947846746320879     
   3.7499950840060663        1.4601205936169759       -3.2911988594669657     
   3.7329952683657979        1.4381905682269363       -3.2871590953607264     
   3.7161747434837906        1.4162105703064061       -3.2826669081921640     
   3.6995384684661090        1.3941871802076804       -3.2777234423703741     
   3.6830914024188459        1.3721272643853304       -3.2723298423044520     
   3.6668388859177767        1.3500373078242305       -3.2664883968125880     
   3.6507854965992834        1.3279242723463760       -3.2602006317735750     
   3.6349361935694446        1.3057947383040656       -3.2534684545359065     
   3.6192959359343320        1.2836555721518703       -3.2462937724480740     
   3.6038696828000383        1.2615133542420871       -3.2386788743282677     
   3.5886616303332346        1.2393749510292889       -3.2306260489946785     
   3.5736771191097034        1.2172471336006208       -3.2221375852654974     
   3.5589199638264333        1.1951365776758056       -3.2132165348983102     
   3.5443951235894957        1.1730499589745680       -3.2038655681810071     
   3.5301067945655760        1.1509941439514755       -3.1940869739317779     
   3.5160591729213593        1.1289757129588285       -3.1838841853779090     
   3.5022572177629243        1.1070015324511981       -3.1732602542769870     
   3.4887043623175487        1.0850781827808831       -3.1622182323865999     
   3.4754051842216285        1.0632123396676025       -3.1507617436688822     
   3.4623634981721381        1.0414106788310828       -3.1388940306162705     
   3.4495835003357627        1.0196797806236173       -3.1266189079257494     
   3.4370690054094837       0.99802641613235643       -3.1139399995594537     
   3.4248238280902896       0.97645716570959529       -3.1008611202143674     
   3.4128517830751619       0.95497841897278590       -3.0873864660571728     
   3.4011563035913852       0.93359685164164574       -3.0735198517848548     
   3.3897412043359409       0.91231904406847697       -3.0592658550337943     
   3.3786095370664313       0.89115129050330033       -3.0446284812358240     
   3.3677651164798235       0.87010017129841621       -3.0296123080273256     
   3.3572109943337125       0.84917207607127132       -3.0142221037795287     
   3.3469506038553831       0.82837339443931235       -2.9984622553939655     
   3.3369866153327195       0.80771042065256715       -2.9823377219767151     
   3.3273228434627171       0.78718944896105825       -2.9658532718990083     
   3.3179615770635564       0.76681677361480816       -2.9490142457366226     
   3.3089058678928254       0.74659854581270579       -2.9318254118607885     
   3.3001587677081190       0.72654096443734772       -2.9142923015821323     
   3.2917221838579209       0.70665013300391166       -2.8964198740067340     
   3.2835995495695229       0.68693210734385879       -2.8782140419149194     
   3.2757927721914086       0.66739289560493908       -2.8596799551476164     
   3.2683045220114764       0.64803841056747657       -2.8408235264851505     
   3.2611370878479136       0.62887461269551181       -2.8216504779729985     
   3.2542919955795142       0.60990731940194287       -2.8021663409217874     
   3.2477722969638663       0.59114230041596016       -2.7823774095815406     
   3.2415795178797566       0.57258523009932816       -2.7622895967325838     
   3.2357155656756902       0.55424183049752074       -2.7419090058900921     
   3.2301823477001435       0.53611768060487996       -2.7212419313040885     
   3.2249813898319246       0.51821821636460719       -2.7002944764897485     
   3.2201142179498206       0.50054901677104091       -2.6790731264319447     
   3.2155823579326182       0.48311537471624710       -2.6575843661155507     
   3.2113873356591256       0.46592263077600293       -2.6358346805254391     
   3.2075302955384259       0.44897603015866316       -2.6138307453813323     
   3.2040127634493203       0.43228067502144363       -2.5915794271378019     
   3.2008351208615053       0.41584176288898611       -2.5690872107797209     
   3.1979988936537751       0.39966420518365631       -2.5463609627616610     
   3.1955048447655230       0.38375296101153289       -2.5234077402730430     
   3.1933535464012976       0.36811289411127390       -2.5002346005032869     
   3.1915457615004996       0.35274874901224962       -2.4768486006418144     
   3.1900820622676704       0.33766519871826794       -2.4532566071431963     
   3.1889630209073658       0.32286684470756555       -2.4294660586665522     
   3.1881888281544235       0.30835821693281140       -2.4054840124013026     
   3.1877596747437025       0.29414370229553732       -2.3813179070065664     
   3.1876757514100547       0.28022764001356215       -2.3569751811414630     
   3.1879370581534729       0.26661429777913703       -2.3324630827302628     
   3.1885435949739502       0.25330777639151947       -2.3077890504320839     
   3.1894951711366559       0.24031215280811224       -2.2829607136408954     
   3.1907914051718791       0.22763138477703748       -2.2579857017506657     
   3.1924319156099230       0.21526935852084428       -2.2328714534205134     
   3.1944161302462390       0.20322979336909697       -2.2076257887792563     
   3.1967436676111305       0.19151637288856627       -2.1822563372208630     
   3.1994137647652039       0.18013267335767758       -2.1567705374044523     
   3.2024254680342068       0.16908217568743034       -2.1311765909285403     
   3.2057778237439010       0.15836821773768150       -2.1054821271870954     
   3.2094700689548787       0.14799407776365392       -2.0796949663089350     
   3.2135010592580571       0.13796291481128797       -2.0538229284228766     
   3.2178692687746349       0.12827778063817163       -2.0278738336577380     
   3.2225735530955149       0.11894163163446692       -2.0018556928771862     
   3.2276123863419102       0.10995730498105338       -1.9757765169448875     
   3.2329846241047164       0.10132754249139353       -1.9496441259896593     
   3.2386879775657533        9.3054966769658520E-002  -1.9234663401403198     
   3.2447213023159236        8.5142105052605999E-002  -1.8972515517302333     
   3.2510823095370327        7.7591365367702281E-002  -1.8710071994185200     
   3.2577690918805899        7.0405048454066588E-002  -1.8447418662733936     
   3.2647801234678013        6.3585335841539248E-002  -1.8184629909539733     
   3.2721127340107827        5.7134313692532857E-002  -1.7921789657936245     
   3.2797650161610292        5.1053948960179341E-002  -1.7658976109211644     
   3.2877346811003676        4.5346080447632886E-002  -1.7396271279351094     
   3.2960186770711957        4.0012460531322347E-002  -1.7133751462294275     
   3.3046150967250298        3.5054707477234714E-002  -1.6871500581374841     
   3.3135212697739789        3.0474332263002779E-002  -1.6609596837880967     
   3.3227345259301515        2.6272732617441008E-002  -1.6348120340449319     
   3.3322514319662702        2.2451182589740881E-002  -1.6087149290368075     
   3.3420700805338299        1.9010851920967298E-002  -1.5826765703622394     
   3.3521866569358565        1.5952786672562169E-002  -1.5567046827826203     
   3.3625981094147619        1.3277918167027281E-002  -1.5308072771616175     
   3.3733021491523516        1.0987062242881152E-002  -1.5049921736280480     
   3.3842945799819404        9.0809147842971782E-003  -1.4792673830455789     
   3.3955723501459545        7.5600569365228409E-003  -1.4536405348081785     
   3.4071320264170879        6.4249536157490184E-003  -1.4281195444120887     
   3.4189701755680773        5.6759486662478764E-003  -1.4027122319861274     
   3.4310829829019198        5.3132708208263324E-003  -1.3774262269242628     
   3.4434670151913380        5.3370310931253329E-003  -1.3522693493553124     
   3.4561184577393504        5.7472220325660572E-003  -1.3272491333058201     
   3.4690334958489615        6.5437180968768160E-003  -1.3023733035371785     
   3.4822079333535072        7.7262771422024201E-003  -1.2776493940759319     
   3.4956379555559849        9.2945393055270387E-003  -1.2530850343160482     
   3.5093193662897235        1.1248026259615074E-002  -1.2286874721817973     
   3.5232479693880308        1.3586142703116977E-002  -1.2044643370671479     
   3.5374195686842356        1.6308177850698158E-002  -1.1804229722637944     
   3.5518303494813424        1.9413300962682456E-002  -1.1565707210634313     
   3.5664749712035828        2.2900567305519814E-002  -1.1329147360229037     
   3.5813496191539684        2.6768914426497759E-002  -1.1094623604339064     
   3.5964497156961244        3.1017163643848988E-002  -1.0862206514858601     
   3.6117703017239577        3.5644018556649115E-002  -1.0631966663681856     
   3.6273071810707975        4.0648075475614220E-002  -1.0403975576377278     
   3.6430553946305579        4.6027805541720923E-002  -1.0178300963816340     
   3.6590099832971603        5.1781572607589865E-002 -0.99550133978932509     
   3.6751663694342298        5.7907618336329847E-002 -0.97341786821309828     
   3.6915195939356806        6.4404083063159590E-002 -0.95158654810752519     
   3.7080646976954341        7.1268987914022475E-002 -0.93001405519232838     
   3.7247963401377149        7.8500240766036455E-002 -0.90870687445238096     
   3.7417095621564442        8.6095636247511820E-002 -0.88767158623998021     
   3.7587994046455435        9.4052861698399326E-002 -0.86691458017257506     
   3.7760605270292231       0.10236949120983674      -0.84644205513276449     
   3.7934879702014186       0.11104300350553409      -0.82626040073799711     
   3.8110756306469469       0.12007073425806958      -0.80637562513602312     
   3.8288189307294331       0.12944995357491074      -0.78679397489315384     
   3.8467121484033981       0.13917780043332328      -0.76752121973857812     
   3.8647499430930594       0.14925130652221341      -0.74856336782004562     
   3.8829265927529448       0.15966739624213844      -0.72992609349932092     
   3.9012367568072719       0.17042292246808621      -0.71161516650559198     
   3.9196747132105756       0.18151458310297919      -0.69363607046577391     
   3.9382351213870734       0.19293900452417390      -0.67599433669049358     
   3.9569122592912791       0.20469272966252738      -0.65869535343924113     
   3.9757000234080309       0.21677213455590305      -0.64174436592036999     
   3.9945934546312429       0.22917357140031314      -0.62514657165852083     
   4.0135860679760427       0.24189327318248388      -0.60890692975977334     
   4.0326721413969580       0.25492732983800614      -0.59303049469763136     
   4.0518463343182063       0.26827180746061607      -0.57752208252703752     
   4.0711025432246117       0.28192260525105439      -0.56238636625179728     
   4.0904350460707022       0.29587557472635062      -0.54762797119200413     
   4.1098377393413017       0.31012649587796837      -0.53325142730032671     
   4.1293045195212343       0.32467100564623053      -0.51926107379458453     
   4.1488300460347247       0.33950466944589230      -0.50566124989259698     
   4.1684078338968931       0.35462295732428650      -0.49245596102619760     
   4.1880321610622744       0.37002129164503117      -0.47964935567835654     
   4.2076973054853823       0.38569497556246368      -0.46724529622977040     
   4.2273967821813514       0.40163921686349902      -0.45524754969371095     
   4.2471248691047023       0.41784919949319566      -0.44365974003231312     
   4.2668754627402592       0.43431991666175840      -0.43248544352399976     
   4.2866424595728461       0.45104640926311212      -0.42172809339605644     
   4.3064201375569908       0.46802357514003567      -0.41139088445720762     
   4.3262023931775175       0.48524621676789259      -0.40147701151617721     
   4.3459827414495464       0.50270913662204109      -0.39198950248869668     
   4.3657558417973092       0.52040694644298746      -0.38293121839750399     
   4.3855152092359262       0.53833430565495810      -0.37430494873976883     
   4.4052547402502285       0.55648573063103690      -0.36611329227781197     
   4.4249690942644335       0.57485569006059478      -0.35835875240652881     
   4.4446514048239720       0.59343865263300799      -0.35104371331153494     
   4.4642963313530686       0.61222884861908611      -0.34417039228545199     
   4.4838973888668434       0.63122065134077765      -0.33774086356976518     
   4.5034492367895282       0.65040819570146979      -0.33175710603853514     
   4.5229453901362362       0.66978566428826092      -0.32622093167282951     
   4.5423801268615023       0.68934719200453820      -0.32113403324443479     
   4.5617473434501505       0.70908681838626464      -0.31649796047400103     
   4.5810413178567018       0.72899848760197727      -0.31231412003104064     
   4.6002559465659800       0.74907614382021315      -0.30858379937578650     
   4.6193858890022099       0.76931368352579987      -0.30530811907547717     
   4.6384246601805188       0.78970495551984676      -0.30248808048807097     
   4.6573669195251313       0.81024366555233307      -0.30012454192038973     
   4.6762065635208643       0.83092371010808286      -0.29821821862811770     
   4.6949382515919496       0.85173869956964587      -0.29676973049951494     
   4.7135562616929008       0.87268224431957897      -0.29577945900427971     
   4.7320544903085562       0.89374805010785252      -0.29524773792839820     
   4.7504275968631262       0.91492963194959565      -0.29517473416486362     
   4.7686698593111387       0.93622060022735987      -0.29556047155553200     
   4.7867755556071216       0.95761446995627431      -0.29640480704926642     
   4.8047397266449892       0.97910466078403680      -0.29770750222750531     
   4.8225566503792621        1.0006846877257782      -0.29946815177869435     
   4.8402206047644754        1.0223478750617723      -0.30168623118199789     
   4.8577266306945432        1.0440878331745740      -0.30436104902358774     
   4.8750690061239936        1.0658976956096122      -0.30749181852221086     
   4.8922427719467407        1.0877709773820108      -0.31107753831990870     
   4.9092425875870092        1.1097010027720486      -0.31511718321686732     
   4.9260631124690235        1.1316810006925806      -0.31960946575285387     
   4.9426997689563947        1.1537043907913063      -0.32455302694206845     
   4.9591464535339611        1.1757643066136563      -0.32994636474757288     
   4.9753993515047270        1.1978542631747562      -0.33578785792314947     
   4.9914527408232203        1.2199672986526089      -0.34207571832958639     
   5.0073016623833695        1.2420968326949193      -0.34880801477653556     
   5.0229419200184751        1.2642359988471163      -0.35598269686436823     
   5.0383685546224726        1.2863782167568996      -0.36359759498417454     
   5.0535762256195795        1.3085166199696978      -0.37165037263405132     
   5.0685611183128074        1.3306444373983659      -0.38013859794467164     
   5.0833182735960776        1.3527549933231793      -0.38905967215371484     
   5.0978431138330151        1.3748416120244187      -0.39841087728957969     
   5.1121314428569349        1.3968974270475094      -0.40818935232952813     
   5.1261786830314549        1.4189157626727322      -0.41839214088339716     
   5.1399810196595865        1.4408900385477867      -0.42901616735174364     
   5.1535338751049551        1.4628133882181036      -0.44005809387470618     
   5.1668330532008824        1.4846792313313824      -0.45151467795984834     
   5.1798743577806690        1.5064808921679038      -0.46338234332874750     
   5.1926543556170515        1.5282116950079434      -0.47565746601926873     
   5.2051688505433233        1.5498650594992061      -0.48833637438556454     
   5.2174140278625245        1.5714344052893896      -0.50141515836322637     
   5.2293860728776522        1.5929131520262008      -0.51488990788784528     
   5.2410819338311256        1.6142946239899150      -0.52875637910902651     
   5.2524970330865628        1.6355726222979339      -0.54301047122751189     
   5.2636287003560795        1.6567401851282604      -0.55764784502548226     
   5.2744731209426874        1.6777913997005705      -0.57266392286655621     
   5.2850272430887983        1.6987193995602912      -0.58805427016548995     
   5.2952876335671277        1.7195180811922484      -0.60381407086734085     
   5.3052512406200876        1.7401811503464177      -0.61993860428459102     
   5.3149153939597937        1.7607021220379284      -0.63642295899487322     
   5.3242766603589544        1.7810748927516027      -0.65326212820839580     
   5.3333319880599817        1.8012929775025679      -0.67045091440051796     
   5.3420794697143918        1.8213506542453501      -0.68798412004659848     
   5.3505156720948861        1.8412414379950750      -0.70585640457085985     
   5.3586386878529879        1.8609594159714149      -0.72406233203009929     
   5.3664450837613984        1.8804986753940476      -0.74259632342997772     
   5.3739337154110274        1.8998531127477971      -0.76145279977615565     
   5.3811011495745902        1.9190170059871878      -0.78062594365573224     
   5.3879458603732928        1.9379842515970438      -0.80010988997209431     
   5.3944655589889408        1.9567493182667377      -0.81989882131234104     
   5.4006583380730504        1.9753062932159455      -0.83998672952872233     
   5.4065222902771239        1.9936496451340400      -0.86036732037121422     
   5.4120558897223603        2.0117738427103937      -0.88103449032464232     
   5.4172568475905862        2.0296733546343795      -0.90198184977155771     
   5.4221240194726903        2.0473424588605216      -0.92320319982936128     
   5.4266558794898856        2.0647761962827396      -0.94469196014575552     
   5.4308509017633853        2.0819688448555578      -0.96644164573586711     
   5.4347075604143811        2.0989156362077468      -0.98844548551254929     
   5.4382254739731835        2.1156108482938292       -1.0106969944909290     
   5.4414031165610055        2.1320497127425746       -1.0331892108490099     
   5.4442393437687358        2.1482272704479053       -1.0559153634996452     
   5.4467333926569879        2.1641385623037399       -1.0788684906208388     
   5.4488845002863613        2.1797786292039998       -1.1020416303905947     
   5.4506922851871593        2.1951428935123038       -1.1254278209869166     
   5.4521559844199885        2.2102263961225734       -1.1490197191181100     
   5.4532752165151450        2.2250247501332758       -1.1728103629621787     
   5.4540492185332354        2.2395333779080309       -1.1967923138600038     
   5.4544783719439565        2.2537478925453049       -1.2209583238873152     
   5.4545622952776043        2.2676639071435680       -1.2453011451198430     
   5.4543009885341860        2.2812772255361375       -1.2698132435310436     
   5.4536944517137087        2.2945838422911784       -1.2944872758292223     
   5.4527430662858549        2.3075793705071606       -1.3193155172529862     
   5.4514468322506318        2.3202601862219483       -1.3442906245106407     
   5.4498061310777359        2.3326222840037092       -1.3694047774733684     
   5.4478217257065680        2.3446618491554574       -1.3946505374820499     
   5.4454943790765284        2.3563752577150590       -1.4200200844078679     
   5.4428244726573070        2.3677588857203791       -1.4455056934894295     
   5.4398127693882969        2.3788092999441313       -1.4710996399653415     
   5.4364600322089132        2.3895232578938801       -1.4967941990742111     
   5.4327677869979283        2.3998975170771875       -1.5225813599523714     
   5.4287371781644538        2.4099286442667687       -1.5484534932058542     
   5.4243689686478760        2.4196137784398859       -1.5744024926035680     
   5.4196646843269960        2.4289498678389512       -1.6004206333841202     
   5.4146254696109040        2.4379342421760750       -1.6264998093164189     
   5.4092536133177873        2.4465640404285205       -1.6526322002716469     
   5.4035502598567504        2.4548365923083981       -1.6788099861209866     
   5.3975169351065801        2.4627494182626686       -1.7050247745310727     
   5.3911559278854781        2.4703002294731400       -1.7312691268427862     
   5.3844687640722171        2.4774865463867739       -1.7575344599879128     
   5.3774577324850057        2.4843062709202295       -1.7838133353073329     
   5.3701251219420314        2.4907573049901641       -1.8100973604676818     
   5.3624728397917778        2.4968375505132387       -1.8363787153401419     
   5.3545035563221433        2.5025454816106558       -1.8626491983261970     
   5.3462191788816185        2.5078791909339264       -1.8889011800318789     
   5.3376227592277843        2.5128367711345581       -1.9151262681238221 ]'; 

center = mean(ring_pts, 2); 

radius = norm(ring_pts(:,1) - center); 

n_pts  = size(ring_pts,2); 

normal = cross(ring_pts(:,1) - center, ring_pts(:,floor(n_pts/4)) - center); 
normal = normal / norm(normal); 

% take the normal with positive z orientation
if normal(3) < 0
    normal = -normal; 
end 
 
papillary_left  = [6.74695740000000    0.05698210000000   -4.85734790000000]'; 
papillary_right = [9.02995910000000    0.31132020000000   -2.38240990000000]'; 


% translate center to origin 
papillary_left  = papillary_left  - center; 
papillary_right = papillary_right - center; 

% get angle to rotate normal to in the y,z plane 
% and rotate accordingly 
theta = atan2(normal(2), normal(1)); 
R = rotation_matrix_z(-theta); 

normal          = R*normal; 
papillary_left  = R*papillary_left; 
papillary_right = R*papillary_right; 

if abs(normal(2)) > eps
    error('did not land in the xz plane'); 
end 

% get angle to place on positive z axis 
phi = atan2(normal(3), normal(1)); 
R = rotation_matrix_y(pi/2 - phi); 

normal          = R*normal; 
papillary_left  = R*papillary_left; 
papillary_right = R*papillary_right; 

if (abs(normal(1)) > eps) || (abs(normal(2)) > eps) 
    error('did not land in the z axis'); 
end 

if abs(normal(3) - 1) > eps
    error('z component of end normal is not in the right place'); 
end 


% compute the midpoint
% rotate this to the negative x axis 
midpoint = 0.5 * (papillary_left(1:2) + papillary_right(1:2)); 
theta = atan2(midpoint(2), midpoint(1)); 

skeleton.ring_offset_angle = -(-theta + pi); 

R = rotation_matrix_z(-theta + pi); 
papillary_left  = R*papillary_left; 
papillary_right = R*papillary_right; 

if output 

    radius 
    papillary_left
    papillary_right
    
    th = 0:.1:2*pi; 
    figure; 
    plot3(radius*cos(th), radius*sin(th), zeros(size(th))); 
    axis equal 
    hold on 
    plot3(papillary_left(1), papillary_left(2), papillary_left(3), '*'); 
    plot3(papillary_right(1), papillary_right(2), papillary_right(3), 'o'); 
    legend('ring', 'left', 'right'); 
    title('mitral skeleton geometry'); 
    xlabel('x')
    ylabel('y')
    zlabel('z')
    
end 


l_to_r_papillary = papillary_right - papillary_left; 
l_to_r_papillary = l_to_r_papillary / norm(l_to_r_papillary);

skeleton.r                   = radius; 

skeleton.papillary(1).name   = 'left'; 
skeleton.papillary(1).center = papillary_left;
skeleton.papillary(1).radius = tip_radius;
skeleton.papillary(1).normal = [0;0;1];

skeleton.l_to_r_papillary    = l_to_r_papillary; 

skeleton.papillary(2).name   = 'right'; 
skeleton.papillary(2).center = papillary_right;
skeleton.papillary(2).radius = tip_radius;
skeleton.papillary(2).normal = [0;0;1];



